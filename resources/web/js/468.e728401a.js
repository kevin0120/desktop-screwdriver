"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[468],{19995:function(t,e,i){i.d(e,{CG:function(){return o},E7:function(){return u},IY:function(){return r},KJ:function(){return a},aE:function(){return c},jy:function(){return d},mY:function(){return l},yq:function(){return n}});var s=i(11586);function n(){return(0,s.Z)({url:"bus/io/cfg/upload",method:"get"})}function o(){return(0,s.Z)({url:"bus/fieldbus/cfg/upload",method:"get"})}function l(t){return(0,s.Z)({url:"bus/io/modify",method:"post",data:t})}function a(t){return(0,s.Z)({url:"bus/filedbus/modify",method:"post",data:t})}function d(t){return(0,s.Z)({url:"bus/io/cfg/download",method:"post",data:t})}function r(t){return(0,s.Z)({url:"bus/filedbus/cfg/download",method:"post",data:t})}function u(){return(0,s.Z)({url:"bus/io/debug/in",method:"put"})}function c(){return(0,s.Z)({url:"bus/io/debug/out",method:"put"})}},96754:function(t,e,i){i.d(e,{GZ:function(){return d},lG:function(){return o}});var s=i(59317);const n={Bool:1,I8:2,U8:3,I16:4,U16:5,I32:6,U32:7,I64:8,U64:9,F32:10,F64:11,String:12,StringUnicode:13,ByteArray:14,RemapArray:15};function o(t){return n[t]}const l={ver:"V1.0.0",moudles:["sys_status"],items:{"0x300101":{name:"pset_start",sdo:"0x300101",group:"sys_status",type:"Bool",len:1,optional:!0},"0x300102":{name:"tool_reverse",sdo:"0x300102",group:"sys_status",type:"Bool",len:1,optional:!0},"0x300401":{name:"fault_reset",sdo:"0x300401",group:"sys_status",type:"Bool",len:1,optional:!0},"0x30010A":{name:"request_Profile_index",sdo:"0x30010A",group:"sys_status",type:"U8",len:8,optional:!0},"0x300125":{name:"tool_enable",sdo:"0x300125",group:"sys_status",type:"Bool",len:1,optional:!0},"0x300403":{name:"result_ack",sdo:"0x300403",group:"sys_status",type:"Bool",len:1,optional:!0},"0x300409":{name:"sync_signal",sdo:"0x300409",group:"sys_status",type:"Bool",len:1,optional:!0},"0x300161":{name:"request_Job_index",sdo:"0x300161",group:"sys_status",type:"U8",len:8,optional:!0},"0x300831":{name:"product_sn",sdo:"0x300831",group:"sys_status",type:"String",len:144,optional:!0}}},a={ver:"V1.0.0",moudles:["status"],items:{"0x300102":{name:"tool_reverse",sdo:"0x300102",group:"status",type:"Bool",len:1,optional:!0},"0x300204":{name:"system_ready",sdo:"0x300204",type:"Bool",len:1,group:"status",optional:!0},"0x300205":{name:"pset_running",sdo:"0x300205",type:"Bool",len:1,group:"status",optional:!0},"0x300209":{name:"system_fault",sdo:"0x300209",type:"Bool",len:1,group:"status",optional:!0},"0x300207":{name:"result_ok",sdo:"0x300207",type:"Bool",len:1,group:"status",optional:!0},"0x300208":{name:"result_nok",sdo:"0x300208",type:"Bool",len:1,group:"status",optional:!0},"0x30020B":{name:"system_fault_code",sdo:"0x30020B",type:"U16",len:16,group:"status",optional:!0},"0x30020A":{name:"active_profile_index",sdo:"0x30020A",type:"U8",len:8,group:"status",optional:!0},"0x300806":{name:"result_torque",sdo:"0x300806",type:"F32",len:32,group:"status",optional:!0},"0x30081E":{name:"result_angle",sdo:"0x30081E",type:"F32",len:32,group:"status",optional:!0},"0x300409":{name:"sync_signal",sdo:"0x300409",type:"Bool",len:1,group:"status",optional:!0},"0x300814":{name:"result_torque_ok",sdo:"0x300814",type:"Bool",len:1,group:"status",optional:!0},"0x300811":{name:"result_angle_ok",sdo:"0x300811",type:"Bool",len:1,group:"status",optional:!0},"0x300262":{name:"active_job_index",sdo:"0x300262",type:"U16",len:16,group:"status",optional:!0},"0x300831":{name:"product_sn",sdo:"0x300831",type:"String",len:144,group:"status",optional:!0}}};function d(t){let e={};return"in"==t&&(e=(0,s.p$)(l)),"out"==t&&(e=(0,s.p$)(a)),e.items}},59317:function(t,e,i){function s(t){let e;if(t instanceof Array){e=[];for(let i=0;i<t.length;i++)e[i]=s(t[i])}else if(t instanceof Object){e={};for(let i of Object.keys(t))e[i]=s(t[i])}else e=t;return e}function n(t,e,i=!1){let s=!0;if(t instanceof Array&&e instanceof Array&&e.length==t.length){for(let o=0;o<t.length;o++)if(s=s&&n(t[o],e[o],i),!s)break}else if(!(t instanceof Object&&e instanceof Object)||t instanceof Array||e instanceof Array)t instanceof Object||e instanceof Object?s=!1:(s=!0,i&&(s=t===e));else for(let o in t){if(!(o in e)){s=!1;break}if(s=s&&n(t[o],e[o],i),!s)break}return s}function o(t,e,i=!1){return i?JSON.stringify(t)===JSON.stringify(e):n(t,e)}i.d(e,{IK:function(){return o},p$:function(){return s}})},89555:function(t,e,i){i.d(e,{Z:function(){return b}});var s=i(66252),n=i(3577),o=i(49963);const l=["id"],a={class:"val-box"},d={class:"num"};function r(t,e,i,r,u,c){return(0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)({"counter-box":!0,"valid-text":!i.textValid}),id:u.cid},[(0,s._)("div",{class:"sub-box",onClick:e[0]||(e[0]=(...t)=>c.subNum&&c.subNum(...t))},[(0,s._)("span",{class:(0,n.C_)(["sub-btn",{forbit:u.num==u.min}])},"-",2)]),(0,s._)("div",a,[(0,s._)("span",d,(0,n.zw)(u.num),1)]),(0,s._)("div",{class:"add-box",onClick:e[1]||(e[1]=(...t)=>c.addNum&&c.addNum(...t))},[(0,s._)("span",{class:(0,n.C_)(["add-btn",{forbit:u.num==u.max}])},"+",2)]),(0,s.wy)((0,s._)("span",{class:"valid-reason"},(0,n.zw)(i.validReason),513),[[o.F8,!i.textValid]])],10,l)}const u={data(){return{num:0,cid:Math.random(),max:0,min:0}},props:{cnum:{type:Number,default:0},_width:{type:String,default:"7.5rem"},_bWidth:{type:String,default:"1.7625rem"},_height:{type:String,default:"3.1431rem"},_ftszie:{type:String,default:"1.5rem"},_min:{type:Number,default:-9999},_max:{type:Number,default:9999},_value:{type:Number,default:1},textValid:{type:Boolean,default:!0},validReason:{type:String,default:"数据不合法"}},methods:{subNum(){this.num=Math.floor(this.num>this._min?this.num-this._value:this._min),this.$emit("update",this.num)},addNum(){Math.floor(this.num=this.num<this._max?this.num+this._value:this._max),this.$emit("update",this.num)},initNum(){this.max=this._max,this.min=this._min,this.num=Math.floor(this.cnum>=this.min&&this.cnum<=this.max?this.cnum:this.min),this.$emit("update",this.num)}},watch:{cnum:{handler:function(){this.initNum()}},_max:{deep:!0,handler:function(){this.initNum()}},_min:{deep:!0,handler:function(){this.initNum()}}},created(){this.initNum()}},c=()=>{(0,o.sj)((t=>({"0c347b10":t._height,"29ed0e55":t._width,"1157763c":t._ftszie})))},h=u.setup;u.setup=h?(t,e)=>(c(),h(t,e)):c;var m=u,p=i(83744);const g=(0,p.Z)(m,[["render",r],["__scopeId","data-v-a7278d4e"]]);var b=g},79468:function(t,e,i){i.r(e),i.d(e,{default:function(){return Ft}});var s=i(66252),n=i(3577),o=i(49963);const l=t=>((0,s.dD)("data-v-1d0fbf78"),t=t(),(0,s.Cn)(),t),a={class:"totalline-box"},d={class:"totalline-nav-box"},r=l((()=>(0,s._)("div",{class:"totalline-line"},null,-1))),u={key:0},c={class:"bytes-order"},h={class:"totalline-node-line"},m={class:"totalline-node"},p={class:"node-input"},g={class:"data-order-line"},b={class:"data-order"},f={class:"string-order-line"},y={class:"string-order"},_={class:"input-line-table"},v={class:"totalline-tr"},S={class:"last-td"},x={class:"mask-box"},I={class:"table-box"},w=["onClick"],B={class:"last-td"},k={class:"div-edit-menu"},C={class:"add-line totalline-tr"},T=l((()=>(0,s._)("td",null,null,-1))),O=l((()=>(0,s._)("td",null,null,-1))),z=l((()=>(0,s._)("td",{class:"last-td"},null,-1))),M={class:"output-line-table"},$={class:"totalline-tr"},L={class:"last-td"},A={class:"mask-box"},V={class:"table-box"},D=["onClick"],N={class:"last-td"},F={class:"div-edit-menu"},W={class:"add-line totalline-tr"},Z=l((()=>(0,s._)("td",null,null,-1))),U=l((()=>(0,s._)("td",null,null,-1))),G=l((()=>(0,s._)("td",{class:"last-td"},null,-1)));function j(t,e,i,l,j,E){const R=(0,s.up)("NewSelect"),q=(0,s.up)("svg-loader"),H=(0,s.up)("LeetxButton");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",d,[(0,s._)("div",{onClick:e[0]||(e[0]=t=>j.activeTab=0)},[(0,s._)("span",{class:(0,n.C_)({brdrbtm:0==j.activeTab,"border-green":0==j.activeTab})},(0,n.zw)(t.$t("settotalline.basicInformation")),3)]),(0,s._)("div",{onClick:e[1]||(e[1]=t=>j.activeTab=1)},[(0,s._)("span",{class:(0,n.C_)({brdrbtm:1==j.activeTab,"border-green":1==j.activeTab})},(0,n.zw)(t.$t("settotalline.input")),3)]),(0,s._)("div",{onClick:e[2]||(e[2]=t=>j.activeTab=2)},[(0,s._)("span",{class:(0,n.C_)({brdrbtm:2==j.activeTab,"border-green":2==j.activeTab})},(0,n.zw)(t.$t("settotalline.output")),3)]),r]),j.hasPermit?((0,s.wg)(),(0,s.iD)("div",u,[(0,s.wy)((0,s._)("div",c,[(0,s._)("div",h,[(0,s._)("span",m,(0,n.zw)(t.$t("settotalline.fieldname")),1),(0,s._)("span",p,(0,n.zw)(E.filedbusname),1)]),(0,s._)("div",g,[(0,s._)("span",b,(0,n.zw)(t.$t("settotalline.databyteorder")),1),(0,s.Wm)(R,{module:j.module,realVal:j.totalSetting.NumeralByteOrder,options:j.numberOrders,onValChng:e[3]||(e[3]=t=>j.totalSetting.NumeralByteOrder=t),class:"data-input"},null,8,["module","realVal","options"])]),(0,s._)("div",f,[(0,s._)("span",y,(0,n.zw)(t.$t("settotalline.characterbyteorder")),1),(0,s.Wm)(R,{module:j.module,realVal:j.totalSetting.StringByteOrder,options:j.stringOrders,onValChng:e[4]||(e[4]=t=>j.totalSetting.StringByteOrder=t),class:"string-input"},null,8,["module","realVal","options"])])],512),[[o.F8,0==j.activeTab]]),(0,s.wy)((0,s._)("table",_,[(0,s._)("tr",v,[(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.address")),1),(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.type")),1),(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.length")),1),(0,s._)("td",S,(0,n.zw)(t.$t("settotalline.function")),1)]),(0,s._)("div",x,[(0,s._)("div",I,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(j.totalSetting.ToolIn.Member,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e,class:(0,n.C_)({"totalline-tr":!0,"active-input":j.activeInput==e}),onClick:t=>E.showTrash("input",e)},[(0,s._)("td",null,(0,n.zw)(parseFloat(t.StartByte).toFixed(1)),1),(0,s._)("td",null,(0,n.zw)(E.getInSdoItem(t.LinkSdo,"type")),1),(0,s._)("td",null,(0,n.zw)(t.BitLength),1),(0,s._)("td",B,(0,n.zw)(E.getInSdoItem(t.LinkSdo,"name")),1),(0,s.wy)((0,s._)("div",k,[(0,s.Wm)(q,{onClick:t=>E.delMember("ToolIn",e),icon:"DelDmrct",class:"del-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:e=>E.eidtFiledBus("ToolIn",t.LinkSdo),icon:"Edit",class:"edit-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:t=>E.up("ToolIn",e),icon:"Up",class:"up-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:t=>E.down("ToolIn",e),icon:"Down",class:"down-btn",size:"2.5rem"},null,8,["onClick"])],512),[[o.F8,j.activeInput==e]])],10,w)))),128)),(0,s._)("tr",C,[(0,s._)("td",null,[(0,s.Wm)(q,{onClick:e[5]||(e[5]=t=>E.setFiledBus("ToolIn")),class:"add-btn",icon:"StaticCircleAdd",size:"2.5rem"})]),T,O,z])])])],512),[[o.F8,1==j.activeTab]]),(0,s.wy)((0,s._)("table",M,[(0,s._)("tr",$,[(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.address")),1),(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.type")),1),(0,s._)("td",null,(0,n.zw)(t.$t("settotalline.length")),1),(0,s._)("td",L,(0,n.zw)(t.$t("settotalline.function")),1)]),(0,s._)("div",A,[(0,s._)("div",V,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(j.totalSetting.ToolOut.Member,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e,class:(0,n.C_)({"totalline-tr":!0,"active-output":j.activeOutput==e}),onClick:t=>E.showTrash("output",e)},[(0,s._)("td",null,(0,n.zw)(parseFloat(t.StartByte).toFixed(1)),1),(0,s._)("td",null,(0,n.zw)(E.getOutSdoItem(t.LinkSdo,"type")),1),(0,s._)("td",null,(0,n.zw)(t.BitLength),1),(0,s._)("td",N,(0,n.zw)(E.getOutSdoItem(t.LinkSdo,"name")),1),(0,s.wy)((0,s._)("div",F,[(0,s.Wm)(q,{onClick:t=>E.delMember("ToolOut",e),icon:"DelDmrct",class:"del-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:e=>E.eidtFiledBus("ToolOut",t.LinkSdo),icon:"Edit",class:"edit-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:t=>E.up("ToolOut",e),icon:"Up",class:"up-btn",size:"2.5rem"},null,8,["onClick"]),(0,s.Wm)(q,{onClick:t=>E.down("ToolOut",e),icon:"Down",class:"down-btn",size:"2.5rem"},null,8,["onClick"])],512),[[o.F8,j.activeOutput==e]])],10,D)))),128)),(0,s._)("tr",W,[(0,s._)("td",null,[(0,s.Wm)(q,{onClick:e[6]||(e[6]=t=>E.setFiledBus("ToolOut")),class:"add-btn",icon:"StaticCircleAdd",size:"2.5rem"})]),Z,U,G])])])],512),[[o.F8,2==j.activeTab]])])):(0,s.kq)("",!0),(0,s.Wm)(H,{enablerun:!1,module:j.module,class:"confirm-box",textColor:"#fff",bgcColor:"#00c155",width:"60.625vw",height:"3.75rem",fontSize:"2.25rem",text:t.$t("confirm.confirm"),onClick:E.submitTotalData},null,8,["module","text","onClick"])])}const E={key:0,class:"totalline-box"},R={class:"totalline-title-line"},q={class:"totalline-title-msg"},H={class:"totalline-group-line"},K={class:"totalline-system-text"},Y={class:"totalline-system-line"},J={class:"totalline-system-text"},P={class:"totalline-signal-line"},Q={class:"totalline-signal-text"},X={class:(0,n.C_)({"totalline-select-signal":!0})},tt={class:"totalline-bit-msg"},et={class:"totalline-delay-line"},it={class:"totalline-delay-text"},st={class:"totalline-select-signal"},nt={class:"totalline-operate-line"};function ot(t,e,i,o,l,a){const d=(0,s.up)("svgloader"),r=(0,s.up)("NewSelect"),u=(0,s.up)("BusSelect"),c=(0,s.up)("Counter");return l.isShow?((0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("div",R,[(0,s._)("span",q,(0,n.zw)(t.$t("dlgtotalline.totalline")),1),(0,s._)("span",{class:"totalline-box-close",onClick:e[0]||(e[0]=(...t)=>a.cancel&&a.cancel(...t))},[(0,s.Wm)(d,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,s._)("div",H,[(0,s._)("div",K,(0,n.zw)(t.$t("dlgtotalline.group")),1),(0,s.Wm)(r,{realVal:l.activeGroup,onValChng:e[1]||(e[1]=t=>l.activeGroup=t),options:l.groups,class:"totalline-select-system"},null,8,["realVal","options"])]),(0,s._)("div",Y,[(0,s._)("div",J,(0,n.zw)(t.$t("dlgtotalline.selectFunc")),1),(0,s.Wm)(u,{realVal:l.activeSdo,isValid:a.isValid,validReason:t.$t("dlginputset.configUsing"),onValChng:e[2]||(e[2]=t=>a.updateBusItem(t)),options:l.items[l.activeGroup],class:(0,n.C_)({"totalline-select-system":!0})},null,8,["realVal","isValid","validReason","options"])]),(0,s._)("div",P,[(0,s._)("div",Q,(0,n.zw)(t.$t("dlgtotalline.byte")),1),(0,s._)("div",X,[(0,s.Wm)(c,{cnum:l.fieldbusItem.byte,style:{float:"left"},_min:0,_max:219,onUpdate:e[3]||(e[3]=t=>a.updateNum(t,"byte"))},null,8,["cnum"]),(0,s._)("span",tt,(0,n.zw)(t.$t("dlgtotalline.bit")),1),(0,s.Wm)(c,{cnum:l.fieldbusItem.bit,textValid:""==l.validAddress,validReason:l.validAddress,style:{float:"right"},_min:l.minBit,_max:l.maxBit,onUpdate:e[4]||(e[4]=t=>a.updateNum(t,"bit"))},null,8,["cnum","textValid","validReason","_min","_max"])])]),(0,s._)("div",et,[(0,s._)("div",it,(0,n.zw)(t.$t("dlgtotalline.length")),1),(0,s._)("div",st,[(0,s.Wm)(c,{cnum:l.fieldbusItem.len,_width:"100%",_min:l.minLen,_max:l.maxLen,_value:8,onUpdate:e[5]||(e[5]=t=>a.updateNum(t,"len"))},null,8,["cnum","_min","_max"])])]),(0,s._)("div",nt,[(0,s._)("div",{class:"totalline-cancel-btn",onClick:e[6]||(e[6]=(...t)=>a.cancel&&a.cancel(...t))},(0,n.zw)(t.$t("dlgtotalline.cancel")),1),(0,s._)("div",{class:"totalline-cnfrm-btn",onClick:e[7]||(e[7]=(...t)=>a.updateTotalLineSetting&&a.updateTotalLineSetting(...t))},(0,n.zw)(t.$t("dlgtotalline.sure")),1)])])):(0,s.kq)("",!0)}var lt=i(73496),at=i(89555),dt=i(96799);const rt=["id"],ut={class:"mask-box"},ct=["onMousedown"];function ht(t,e,i,l,a,d){const r=(0,s.up)("svgloader");return(0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)({select:!0,"hight-light":a.isShow,"valid-select":!i.isValid})},[(0,s.wy)((0,s._)("input",{id:a.sltId,class:"select-val",type:"text",readonly:"",onClick:e[0]||(e[0]=(...t)=>d.showOptions&&d.showOptions(...t)),onBlur:e[1]||(e[1]=(...t)=>d.onBlur&&d.onBlur(...t)),"onUpdate:modelValue":e[2]||(e[2]=t=>a.selectValue=t)},null,40,rt),[[o.nr,a.selectValue]]),(0,s._)("div",{class:"btn",onClick:e[3]||(e[3]=(...t)=>d.showOptions&&d.showOptions(...t))},[(0,s.Wm)(r,{icon:"Vector",class:(0,n.C_)(["arrow",{rotate:a.rotate}]),size:i.btnSize},null,8,["class","size"])]),(0,s.wy)((0,s._)("div",ut,[(0,s._)("div",{class:(0,n.C_)({"options-box":!0,isScroll:d.isScroll})},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.options,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:(0,n.C_)({"option-text":!0,"disable-option":!t.optional}),onMousedown:t=>d.valChng(e)},(0,n.zw)(e),43,ct)))),128))],2)],512),[[o.F8,a.isShow]]),(0,s.wy)((0,s._)("span",{class:"valid-reason"},(0,n.zw)(i.validReason),513),[[o.F8,!i.isValid]])],2)}var mt=i(84965);const pt={components:{svgloader:lt.Z},props:{options:{type:Object,default:()=>({})},realVal:{default:""},color:{type:String,default:()=>"blue"},isReturnKey:{type:Boolean,default:!1},maxSize:{type:Number,default:7},height:{type:Number,default:3.125},width:{type:Number,default:17.625},fntSize:{type:String,default:"1.625rem"},btnSize:{type:String,default:"1.2rem"},optional:{type:Boolean,default:!0},isAllowChng:{type:Boolean,default:!0},clbck:{type:Function,default:function(){}},isAllowUse:{type:Boolean,default:!0},validReason:{type:String,default:""},isValid:{type:Boolean,default:!0}},data(){return{selectValue:"",rotate:!1,isShow:!1,sltId:"slt-"+1e6*Math.random().toFixed(6)}},methods:{showOptions(){this.optional&&(this.isShow=!this.isShow,this.rotate=!this.rotate)},valChng(t){let e=this.options[t];if(this.isAllowChng)if(this.options[t].optional)this.selectValue=t,this.onBlur(),this.$emit("valChng",e);else{let t=this.$t("dlginputset.configUsing");mt.c.error([t])}else this.clbck&&this.clbck()},onBlur(){this.isShow=!1,this.rotate=!1},getSize(){let t=Math.min(window.innerWidth/800,window.innerHeight/1280).toFixed(3);return 16*t},initData(){if(this.isReturnKey)this.selectValue=this.realVal;else for(let t in this.options)this.options[t].val==this.realVal&&(this.selectValue=t)}},computed:{optiponsHeight(){let t=Object.keys(this.options).length,e=t>this.maxSize?this.maxSize:t,i=e*(this.getSize()*this.height+2)/this.getSize();return i+"rem"},optiponsWidth(){return(this.width*this.getSize()+18)/this.getSize()+"rem"},maskWidth(){return this.width+"rem"},singleHeight(){return this.height+"rem"},innerWidth(){return(this.width*this.getSize()-4)/this.getSize()+"rem"},singleWidth(){return this.width+"rem"},textWidth(){return.96*(this.width*this.getSize()-4)/this.getSize()+"rem"},isScroll(){let t=Object.keys(this.options).length;return t>this.maxSize}},created(){this.initData()},watch:{options:{deep:!0,immediate:!0,handler:function(){this.initData()}},realVal:{deep:!0,immediate:!0,handler:function(){this.initData()}}}},gt=()=>{(0,o.sj)((t=>({"315e22fc":t.fntSize,"27cfef0d":t.singleWidth,"8f420e80":t.singleHeight,"2d005a81":t.innerWidth,"25ff4bd2":t.optiponsHeight,f3a01c8a:t.optiponsWidth,"5bcf55f0":t.textWidth})))},bt=pt.setup;pt.setup=bt?(t,e)=>(gt(),bt(t,e)):gt;var ft=pt,yt=i(83744);const _t=(0,yt.Z)(ft,[["render",ht],["__scopeId","data-v-69493f33"]]);var vt=_t,St=i(65884),xt=i(59317),It={components:{svgloader:lt.Z,Counter:at.Z,NewSelect:dt.Z,BusSelect:vt},props:{mask:{type:Int8Array,default:null},sdoItems:{required:!0,type:Object,default:function(){return{}}},sdoType:{type:String,default:"in"},curItem:{type:Object,default:function(){return{sdo:void 0,byte:0,bit:0,len:6,group:"sys_status",type:"Bool,"}}}},data(){return{validAddress:"",bits:[1,2,3,4,5,6,7,8],fieldbusItem:{sdo:void 0,byte:1,bit:0,len:6,group:"sys_status",type:"Bool,"},groups:{},items:{},isShow:!0,activeGroup:void 0,activeSdo:"0x300101",minBit:0,maxBit:7,minLen:1,maxLen:1760,curType:"Bool",maskId:0}},methods:{updateTotalLineSetting(){this.allowConfirm&&(this.fieldbusItem.sdo=this.activeSdo,this.fieldbusItem.group=this.activeGroup,this.fieldbusItem.type=this.sdoItems[this.activeSdo].type,this.onConfirm&&this.onConfirm(this.fieldbusItem),this.isShow=!1,St.g.descend(this.maskId))},cancel(){St.g.descend(this.maskId),this.isShow=!1,this.onCancel&&this.onCancel()},updateNum(t,e){this.fieldbusItem[e]=t},initStatus(){const t=this.cancel;this.maskId=St.g.rise(15,t)},addrSuggestion(){if("Bool"==this.fieldbusItem.type){for(let t=0;t<220;t++)for(let e=0;e<8;e++)if(0==this.mask[8*t+e])return this.fieldbusItem.bit=e,void(this.fieldbusItem.byte=t)}else{let t=0,e=parseInt(this.sdoItems[this.activeSdo].len/8);for(let i=0;i<220;i++){for(let e=0;e<8;e++)if(1==this.mask[8*i+e]){t=-1;break}if(e%2==0&&-1==t&&i%2==0&&(i+=1),t+=1,t==e){this.fieldbusItem.byte=i-t+1;break}}}},updateBusItem(t){this.fieldbusItem.len=t.len,this.fieldbusItem.type=t.type,this.fieldbusItem.name=t.name,this.fieldbusItem.sdo=t.val,this.activeSdo=t.val,this.addrSuggestion()},initGroupsAndItems(){this.groups={},this.items={};for(let t in this.sdoItems){let e=this.sdoItems[t],i=this.sdoItems[t].group,s=this.sdoItems[t].name;void 0==this.groups[i]?(this.groups[i]=i,this.items[i]={},this.items[i][s]={val:t,...e}):this.items[i][s]={val:t,...e}}},initConfig(){const t=this.curItem.sdo;t?(this.activeGroup=this.curItem.group,this.activeSdo=this.curItem.sdo,this.fieldbusItem=(0,xt.p$)(this.curItem)):"in"==this.sdoType?(this.fieldbusItem={sdo:"0x300101",bit:0,type:"Bool",len:1,byte:0,group:"sys_status"},this.activeGroup="sys_status",this.activeSdo="0x300101"):"out"==this.sdoType&&(this.fieldbusItem={sdo:"0x300204",bit:0,type:"Bool",len:1,byte:0,group:"status"},this.activeGroup="status",this.activeSdo="0x300204")}},watch:{activeGroup:{handler:function(t,e){if(t!=e&&void 0!=e){let e=this.items[t],i=Object.keys(e)[0];this.activeSdo=e[i].val}}},activeSdo:{handler:function(){this.curType=this.sdoItems[this.activeSdo].type,"Bool"!=this.curType?(this.minBit=0,this.fieldbusItem.bit=0,this.maxBit=0):(this.minBit=0,this.maxBit=7),"String"!=this.curType?(this.minLen=this.sdoItems[this.activeSdo].len,this.maxLen=this.sdoItems[this.activeSdo].len):(this.minLen=8,this.maxLen=1024)}},fieldbusItem:{handler(t){for(let e=0;e<t.len;e++)if(1==this.mask[8*t.byte+t.bit+e])return void(this.validAddress=`${(t.byte+Math.floor((t.bit+e)/8)+(t.bit+e)%8*.1).toFixed(1)}已占用`);16!=t.len&&32!=t.len||1!=Math.round(t.byte%2)?t.len+8*t.byte+t.bit>1760?this.validAddress=`${t.byte}.${t.bit} 所选地址长度不够`:this.validAddress="":this.validAddress=`${t.byte}.${t.bit} 起始地址不能为奇数`},deep:!0}},created(){this.initGroupsAndItems(),this.initConfig(),this.initStatus()},computed:{isValid(){return this.sdoItems[this.activeSdo].optional},allowConfirm(){return this.isValid&&""==this.validAddress}}};const wt=(0,yt.Z)(It,[["render",ot],["__scopeId","data-v-69d520d0"]]);var Bt=wt,kt=i(92797);const Ct=t=>new Promise(((e,i)=>{let s=(0,o.ri)(Bt,t).use(kt.Z).mount(document.createElement("div"));document.body.appendChild(s.$el),s.onConfirm=function(t){e(t)},s.onCancel=function(t){i(t)}}));var Tt=Ct,Ot=i(96754),zt=i(19995),Mt=i(10335),$t=i(32015);const Lt={components:{LeetxButton:Mt.Z,NewSelect:dt.Z},data(){return{module:"DEV_BUS",activeTab:0,nodeName:{},totalSetting:{Type:"FieldBus",NumeralByteOrder:"1234",StringByteOrder:"ABCD",ToolIn:{ByteLength:220,Member:[]},ToolOut:{ByteLength:220,Member:[]}},stringOrders:{ABCD:"ABCD",DCBA:"DCBA",CDAB:"CDAB"},numberOrders:{1234:"1234",3412:"3412",4321:"4321"},activeInput:-1,activeOutput:-1,hasPermit:!0,addrMask:{ToolIn:null,ToolOut:null},sdoItems:{ToolIn:{},ToolOut:{}},oldSetting:{Type:"FieldBus",NumeralByteOrder:"1234",StringByteOrder:"ABCD",ToolIn:{ByteLength:220,Member:[]},ToolOut:{ByteLength:220,Member:[]}},isFirstChange:!0,filedbusTypes:{0:"Undetected",1:"Profinet",2:"Ethercat"}}},methods:{up(t,e){e>0&&(this.totalSetting[t].Member[e-1]=this.totalSetting[t].Member.splice(e,1,this.totalSetting[t].Member[e-1])[0])},down(t,e){e<this.totalSetting[t].Member.length-1&&(this.totalSetting[t].Member[e]=this.totalSetting[t].Member.splice(e+1,1,this.totalSetting[t].Member[e])[0])},setFiledBus(t){let e="ToolIn"==t?"in":"out",i=this.sdoItems[t],s={sdoItems:i,mask:this.addrMask[t],key:t,sdoType:e};Tt(s).then((e=>{this.addMember(t,e)})).catch((t=>{console.log(t)}))},eidtFiledBus(t,e){let i,s="ToolIn"==t?"in":"out",n=this.sdoItems[t],o="ToolIn"==t?this.activeInput:this.activeOutput,l=this.totalSetting[t].Member[o].StartByte,a=Math.floor(l),d=Math.round(10*(l-a));for(let u=0;u<this.totalSetting[t].Member[o].BitLength;u++)this.addrMask[t][8*a+d+u]=0;n[e].optional=!0,i={sdo:e,byte:a,bit:d,len:this.totalSetting[t].Member[o].BitLength,group:n[e].group,type:n[e].type};let r={sdoItems:n,mask:this.addrMask[t],sdoType:s,curItem:i};Tt(r).then((e=>{let i=(0,Ot.lG)(e.type),s=e.len,n={StartByte:e.byte+.1*e.bit,BitLength:s,LinkSdo:e.sdo,type:i};this.totalSetting[t].Member[o]=n;for(let o=0;o<e.len;o++)this.addrMask[t][Math.round(8*e.byte+e.bit+o)]=1;this.updateSdoItemsOptional(t,e.sdo,!1)})).catch((()=>{for(let e=0;e<this.totalSetting[t].Member[o].BitLength;e++)this.addrMask[t][8*a+d+e]=1;this.updateSdoItemsOptional(t,e,!1)}))},submitTotalData(){(0,zt.IY)(this.totalSetting).then((t=>{0==t.status?(this.oldSetting=(0,xt.p$)(this.totalSetting),mt.c.success([this.$t("setop.saveSuc")])):mt.c.error([`保存失败,错误代码${t.status}`])})).catch((()=>{mt.c.error(["系统下发配置异常,保存失败"])}))},showTrash(t,e){"input"==t?this.activeInput=this.activeInput==e?-1:e:this.activeOutput=this.activeOutput==e?-1:e},addMember(t,e){let i=(0,Ot.lG)(e.type),s=e.len;this.totalSetting[t].Member.push({StartByte:e.byte+.1*e.bit,BitLength:s,LinkSdo:e.sdo,type:i});for(let n=0;n<e.len;n++)this.addrMask[t][Math.round(8*e.byte+e.bit+n)]=1;this.updateSdoItemsOptional(t,e.sdo,!1)},delMember(t,e){let i=this.$t("dbgdmrct.deleteConfigurate"),s=this.$t("dbgdmrct.yes"),n=this.$t("dbgdmrct.no"),o=this.$t("settotalline.confirmDeletion");(0,$t.Z)({title:i,confirmText:s,cancelText:n,msg:o}).then((()=>{let i=this.totalSetting[t].Member[e],s=Math.floor(i.StartByte),n=Math.round(10*(i.StartByte-s)),o=this.totalSetting[t].Member[e].LinkSdo;this.totalSetting[t].Member.splice(e,1);for(let e=0;e<i.BitLength;e++)this.addrMask[t][8*s+n+e]=0;this.updateSdoItemsOptional(t,o,!0)}))},getInSdoItem(t,e){let i=this.sdoItems["ToolIn"][t];return i?i[e]:void 0},getOutSdoItem(t,e){let i=this.sdoItems["ToolOut"][t];return i?i[e]:""},initSdoItems(){this.sdoItems["ToolIn"]=(0,Ot.GZ)("in"),this.sdoItems["ToolOut"]=(0,Ot.GZ)("out")},initAddress(t){let e=t["ToolIn"].Member,i=t["ToolOut"].Member;for(let s=0;s<e.length;s++){let t=e[s],i=Math.floor(t.StartByte),n=Math.round(10*(t.StartByte-i));for(let e=0;e<t.BitLength;e++)this.addrMask.ToolIn[8*i+n+e]=1}for(let s=0;s<i.length;s++){let t=i[s],e=Math.floor(t.StartByte),n=Math.round(10*(t.StartByte-e));for(let i=0;i<t.BitLength;i++)this.addrMask.ToolOut[8*e+n+i]=1}},async getFieldbusData(){await(0,zt.CG)().then((t=>{if(0==t.status){if(void 0==t.data["Type"]){let e=t.data.ToolIn,i=t.data.ToolOut;e||(e={ByteLength:220,Member:[]}),i||(i={ByteLength:220,Member:[]}),this.totalSetting={Type:"FieldBus",NumeralByteOrder:"1234",StringByteOrder:"ABCD",ToolIn:e,ToolOut:i}}else this.totalSetting=t.data;this.initSdoItemsOptional(),this.initAddress(this.totalSetting),this.oldSetting=(0,xt.p$)(this.totalSetting)}else mt.c.error(["获取总线数据失败"])})).catch((()=>{this.oldSetting=(0,xt.p$)(this.totalSetting)}))},updateSdoItemsOptional(t,e,i){e in this.sdoItems[t]?this.sdoItems[t][e].optional=i:console.log(t,e,i)},initSdoItemsOptional(){this.totalSetting.ToolIn.Member.forEach((t=>{this.updateSdoItemsOptional("ToolIn",t.LinkSdo,!1)})),this.totalSetting.ToolOut.Member.forEach((t=>{this.updateSdoItemsOptional("ToolOut",t.LinkSdo,!1)}))}},created(){this.addrMask.ToolIn=new Int8Array(160),this.addrMask.ToolOut=new Int8Array(160),this.initSdoItems(),this.getFieldbusData()},beforeRouteLeave(t,e,i){if(JSON.stringify(this.oldSetting)===JSON.stringify(this.totalSetting)||this.$store.state.g_status.busy)return void i();let s=this.$t("setcontrol.saveSet"),n=this.$t("setcontrol.yes"),o=this.$t("setcontrol.no"),l=this.$t("settotalline.isSaveBusSet");(0,$t.Z)({title:s,confirmText:n,cancelText:o,msg:l}).then((()=>{(0,zt.IY)(this.totalSetting).then((t=>{if(0==t.status){let t=this.$t("settable.success");mt.c.success([t])}else mt.c.error([`保存失败,错误代码${t.status}`])})).catch((()=>{mt.c.error(["系统下发配置异常,保存失败"])})).finally((()=>{i()}))})).catch((()=>{i()}))},computed:{enabled(){return this.module in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.module]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.5},filedbusname(){return this.$store.state.g_status.anybustype in this.filedbusTypes?this.filedbusTypes[this.$store.state.g_status.anybustype]:"NotExist"}},watch:{}},At=()=>{(0,o.sj)((t=>({b234a87e:t.pointerEvent,e514bfb2:t.opacity})))},Vt=Lt.setup;Lt.setup=Vt?(t,e)=>(At(),Vt(t,e)):At;var Dt=Lt;const Nt=(0,yt.Z)(Dt,[["render",j],["__scopeId","data-v-1d0fbf78"]]);var Ft=Nt}}]);
//# sourceMappingURL=468.e728401a.js.map