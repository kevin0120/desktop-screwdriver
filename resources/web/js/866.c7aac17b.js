"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[866],{45438:function(t,i,a){a.r(i),a.d(i,{default:function(){return st}});var e=a(66252),s=a(3577),n=a(49963);const o=t=>((0,e.dD)("data-v-0859b8be"),t=t(),(0,e.Cn)(),t),l={class:"io-container"},u={class:"io-box"},p={class:"inner-box"},d=o((()=>(0,e._)("span",null,null,-1))),h={class:"left-box"},r=["onClick"],c=["onClick"],m={key:0,class:"circle"},S={class:"right-box"},g=["onClick"],f=["onClick"],v=o((()=>(0,e._)("div",{class:"IO"}," IO ",-1)));function k(t,i,a,o,k,L){const w=(0,e.up)("LeetxButton");return(0,e.wg)(),(0,e.iD)("div",l,[(0,e._)("div",u,[(0,e._)("div",p,[((0,e.wg)(),(0,e.iD)(e.HY,null,(0,e.Ko)(8,(t=>(0,e._)("div",{class:"io-line",key:t},[(0,e._)("span",null,"I"+(0,s.zw)(t),1),d,(0,e._)("span",null,"O"+(0,s.zw)(t),1)]))),64))]),(0,e._)("div",h,[((0,e.wg)(),(0,e.iD)(e.HY,null,(0,e.Ko)(8,(i=>(0,e._)("div",{class:"io-left-line",key:i},[(0,e.wy)((0,e._)("span",{class:"left-edit",onClick:t=>L.edit(0,i-1)},(0,s.zw)(t.$t("setio.editor")),9,r),[[n.F8,k.showLeftEdit==i]]),(0,e._)("span",{class:(0,s.C_)(["left-input",{"active-io":k.showLeftEdit==i}]),onClick:t=>k.showLeftEdit=i},(0,s.zw)(k.input["names"][i-1]),11,c),L.isShow(0,i-1)?((0,e.wg)(),(0,e.iD)("span",m)):(0,e.kq)("",!0),(0,e._)("span",{class:(0,s.C_)({"left-line":!0,green:k.showLeftEdit==i})},null,2)]))),64))]),(0,e._)("div",S,[((0,e.wg)(),(0,e.iD)(e.HY,null,(0,e.Ko)(8,(i=>(0,e._)("div",{class:"io-right-line",key:i},[(0,e.wy)((0,e._)("span",{class:"right-edit",onClick:t=>L.edit(1,i-1)},(0,s.zw)(t.$t("setio.editor")),9,g),[[n.F8,k.showRightEdit==i]]),(0,e._)("span",{class:(0,s.C_)(["right-input",{"active-io":k.showRightEdit==i}]),onClick:t=>k.showRightEdit=i},(0,s.zw)(k.output["names"][i-1]),11,f),(0,e._)("span",{class:(0,s.C_)({"right-line":!0,green:k.showRightEdit==i})},null,2)]))),64))]),v]),(0,e.Wm)(w,{enablerun:!1,module:k.module,class:"confirm-box",textColor:"#fff",bgcColor:"#00c155",width:"60.625vw",height:"3.75rem",fontSize:"2.25rem",fontFamily:"--SHSC-B",text:t.$t("confirm.confirm"),onClick:L.submitIoData},null,8,["module","text","onClick"])])}var L=a(47294);const w={key:0,class:"input-box"},b={class:"input-title-line"},O={class:"input-title-msg"},y={class:"inner-box"},D={class:"input-use-line"},_={class:"input-use-text"},C={class:"input-system-line"},x={class:"input-system-text"},B={class:"input-signal-line"},I={class:"input-signal-text"},$={class:"input-operate-line"};function U(t,i,a,n,o,l){const u=(0,e.up)("svgloader"),p=(0,e.up)("LeetxSwitch"),d=(0,e.up)("NewSelect"),h=(0,e.up)("OptionalSelect");return o.isShow?((0,e.wg)(),(0,e.iD)("div",w,[(0,e._)("div",b,[(0,e._)("span",O,(0,s.zw)(a.signal)+(0,s.zw)(t.$t("inputsetting.configuration")),1),(0,e._)("span",{class:"input-box-close",onClick:i[0]||(i[0]=(...t)=>l.cancel&&l.cancel(...t))},[(0,e.Wm)(u,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,e._)("div",y,[(0,e._)("div",D,[(0,e._)("div",_,(0,s.zw)(t.$t("dlginputset.useConfig")),1),(0,e.Wm)(p,{value:o.isUse,class:"program-use-btn",height:2,modelValue:o.isUse,"onUpdate:modelValue":i[1]||(i[1]=t=>o.isUse=t)},null,8,["value","modelValue"])]),(0,e._)("div",C,[(0,e._)("div",x,(0,s.zw)(t.$t("inputsetting.configuration")),1),(0,e.Wm)(d,{class:"input-select-system",options:o.groups,realVal:o.activeGroup,onValChng:i[2]||(i[2]=t=>l.updateGroup(t))},null,8,["options","realVal"])]),(0,e._)("div",B,[(0,e._)("div",I,(0,s.zw)(t.$t("inputsetting.singnal")),1),(0,e.Wm)(h,{class:"input-select-signal",realVal:o.inputSetting.LinkSdo,options:o.ownOptions[o.activeGroup],isValid:l.isValid,validReason:l.validReason,onValChng:i[3]||(i[3]=t=>o.inputSetting.LinkSdo=t)},null,8,["realVal","options","isValid","validReason"])])]),(0,e._)("div",$,[(0,e._)("div",{class:"input-cancel-btn",onClick:i[4]||(i[4]=(...t)=>l.cancel&&l.cancel(...t))},(0,s.zw)(t.$t("inputsetting.cancel")),1),(0,e._)("div",{class:"input-cnfrm-btn",onClick:i[5]||(i[5]=(...t)=>l.validSubmit&&l.validSubmit(...t))},(0,s.zw)(t.$t("inputsetting.confirm")),1)])])):(0,e.kq)("",!0)}var F=a(84965),j=a(73496),T=a(16496),M=a(52097),E=a(83067),A=a(59317),z=a(8207),V=a(65884),Z={components:{svgloader:j.Z,LeetxSwitch:E.Z,NewSelect:T.Z,OptionalSelect:M.Z},data(){return{inputSetting:{LinkSdo:"0x11101",Not:0,BitLength:1,StartByte:"0.0"},isUse:0,isShow:!0,groups:{},activeGroup:"213312",oldLinkSdo:void 0,ownOptions:void 0,maskId:0}},props:{inptData:{type:Object,default:function(){return{LinkSdo:"0x11101",Not:0,BitLength:1,StartByte:"0.0"}}},signal:{type:String,default:()=>`I?${(void 0).$t("dlginputset.config")}`},inputOptions:{type:Object,default:function(){return(0,z.v7)()}},isActive:{type:Number,default:0}},computed:{isValid(){let t=(0,z.ap)(this.inputSetting.LinkSdo).group,i=(0,z.ap)(this.inputSetting.LinkSdo).name;return this.ownOptions[t][i].optional},validReason(){return this.$t("dlginputset.configUsing")}},methods:{setupIoInput(t){this.isShow=!1,this.onConfirm&&this.onConfirm({data:this.inputSetting,isUse:this.isUse,isSame:t}),V.g.descend(this.maskId)},cancel(){this.isShow=!1,this.onCancel&&this.onCancel(),V.g.descend(this.maskId)},initData(){this.isUse=this.isActive,this.inputSetting=(0,A.p$)(this.inptData),this.ownOptions=(0,A.p$)(this.inputOptions),this.oldLinkSdo=this.inputSetting.LinkSdo;for(let a in this.ownOptions.moudles)this.groups[this.ownOptions.moudles[a]]=this.ownOptions.moudles[a];let t=(0,z.ap)(this.oldLinkSdo).group,i=(0,z.ap)(this.oldLinkSdo).name;!this.ownOptions[t][i].optional&&this.isActive&&(this.ownOptions[t][i].optional=!0)},updateGroup(t){this.activeGroup=t;for(let i in this.ownOptions[t]){this.inputSetting.LinkSdo=this.ownOptions[t][i].val;break}},initStatus(){this.maskId=V.g.rise(15,this.cancel)},setGroup(){this.activeGroup=(0,z.ap)(this.oldLinkSdo).group},validSubmit(){this.inputSetting.LinkSdo;let t=(0,z.ap)(this.inputSetting.LinkSdo).group,i=(0,z.ap)(this.inputSetting.LinkSdo).name,a=this.inputSetting.LinkSdo==this.oldLinkSdo?1:0;if(!this.isUse||this.ownOptions[t][i].optional)this.setupIoInput(a);else{let t=this.$t("dlginputset.configUsing"),i=this.$t("dlginputset.seletAgain");F.c.error([t,i])}}},mounted(){this.initData(),this.setGroup(),this.initStatus()},watch:{inptData:{immediate:!0,deep:!0,handler:function(){this.initData(),this.setGroup()}},inputOptions:{immediate:!0,deep:!0,handler:function(){this.initData(),this.setGroup()}},isActive:{immediate:!0,handler:function(){this.isUse=this.isActive}}}},G=a(83744);const R=(0,G.Z)(Z,[["render",U],["__scopeId","data-v-55a34646"]]);var N=R,K=a(92797),W=a(57900),H=a.n(W);const q=(t={})=>{if("object"!=typeof t)throw new Error("props must be a object");return new Promise(((i,a)=>{let e=(0,n.ri)(N,t).use(K.Z).use(H()).mount(document.createElement("div"));document.body.appendChild(e.$el),e.onConfirm=function(t){i(t)},e.onCancel=function(t){a(t)}}))};var Y=q,P=a(19995),J=a(80283),Q=a(15637);const X={components:{LeetxButton:Q.Z},data(){return{module:"DEV_BUS",inputMember:{StartByte:null,BitLength:1,LinkSdo:"0x300401",Not:0},outputMember:{StartByte:null,BitLength:1,LinkSdo:"0x300204"},showLeftEdit:null,showRightEdit:null,input:{data:[],names:["","","","","","","",""]},output:{data:[],names:["","","","","","","",""]},inputOptions:void 0,outputOptions:void 0,ioData:{},oldData:{},isAllowLeave:!0,isServerChangeData:!0}},methods:{edit(t,i){if(0==t){let t=this.input.data[i],a=this.inputOptions,e=null===t.StartByte?0:1,s=(0,z.ap)(t.LinkSdo).group,n=(0,z.ap)(t.LinkSdo).name,o=a[s][n].optional,l={signal:`I${i+1}`,inptData:t,inputOptions:a,isActive:e};return void Y(l).then((t=>{if(o||e){if(o&&!e)if(t.isUse&&t.isSame)this.input.data[i]=t.data,this.input.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.input.names[i]=(0,z.ap)(t.data.LinkSdo).name,this.inputOptions[s][n].optional=!1;else if(t.isUse&&!t.isSame){this.input.data[i]=t.data,this.input.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.input.names[i]=(0,z.ap)(t.data.LinkSdo).name;let a=(0,z.ap)(t.data.LinkSdo).group,e=(0,z.ap)(t.data.LinkSdo).name;this.inputOptions[a][e].optional=!1}else t.isUse||t.isSame||(this.input.data[i]=t.data,this.input.data[i].StartByte=null,this.input.names[i]="")}else if(t.isUse&&!t.isSame){this.input.data[i]=t.data,this.input.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.input.names[i]=(0,z.ap)(t.data.LinkSdo).name;let a=(0,z.ap)(t.data.LinkSdo).group,e=(0,z.ap)(t.data.LinkSdo).name;this.inputOptions[a][e].optional=!1}else t.isUse||t.isSame||(this.input.data[i]=t.data,this.input.data[i].StartByte=null,this.input.names[i]="");if(!o&&e)if(t.isUse&&t.isSame)this.input.data[i]=t.data,this.input.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.input.names[i]=(0,z.ap)(t.data.LinkSdo).name,this.inputOptions[s][n].optional=!1;else if(t.isUse&&!t.isSame){this.input.data[i]=t.data,this.input.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.input.names[i]=(0,z.ap)(t.data.LinkSdo).name,this.inputOptions[s][n].optional=!0;let a=(0,z.ap)(t.data.LinkSdo).group,e=(0,z.ap)(t.data.LinkSdo).name;this.inputOptions[a][e].optional=!1}else if(!t.isUse&&t.isSame){this.input.data[i]=t.data,this.input.data[i].StartByte=null,this.input.names[i]="";let a=(0,z.ap)(t.data.LinkSdo).group,e=(0,z.ap)(t.data.LinkSdo).name;this.inputOptions[a][e].optional=!0}else t.isUse||t.isSame||(this.input.data[i]=t.data,this.inputOptions[s][n].optional=!0,this.input.data[i].StartByte=null,this.input.names[i]="")})).catch((t=>{console.log(t)}))}let a=this.output.data[i],e=this.outputOptions,s=null===a.StartByte?0:1,n=(0,z.j8)(a.LinkSdo).group,o=(0,z.j8)(a.LinkSdo).name,l=e[n][o].optional,u={signal:`O${i+1}`,otptData:a,outputOptions:e,isActive:s};(0,L.Z)(u).then((t=>{if(l||s){if(l&&!s)if(t.isUse&&t.isSame)this.output.data[i]=t.data,this.output.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.output.names[i]=(0,z.j8)(t.data.LinkSdo).name,this.outputOptions[n][o].optional=!1;else if(t.isUse&&!t.isSame){this.output.data[i]=t.data,this.output.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.output.names[i]=(0,z.j8)(t.data.LinkSdo).name;let a=(0,z.j8)(t.data.LinkSdo).group,e=(0,z.j8)(t.data.LinkSdo).name;this.outputOptions[a][e].optional=!1}else t.isUse||t.isSame||(this.output.data[i]=t.data,this.output.data[i].StartByte=null,this.output.names[i]="")}else if(t.isUse&&!t.isSame){this.output.data[i]=t.data,this.output.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.output.names[i]=(0,z.j8)(t.data.LinkSdo).name;let a=(0,z.j8)(t.data.LinkSdo).group,e=(0,z.j8)(t.data.LinkSdo).name;this.outputOptions[a][e].optional=!1}else t.isUse||t.isSame||(this.output.data[i]=t.data,this.output.data[i].StartByte=null,this.output.names[i]="");if(!l&&s)if(t.isUse&&t.isSame)this.output.data[i]=t.data,this.output.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.output.names[i]=(0,z.j8)(t.data.LinkSdo).name,this.outputOptions[n][o].optional=!1;else if(t.isUse&&!t.isSame){this.output.data[i]=t.data,this.output.data[i].StartByte=parseFloat((0+.1*i).toFixed(1)),this.output.names[i]=(0,z.j8)(t.data.LinkSdo).name,this.outputOptions[n][o].optional=!0;let a=(0,z.j8)(t.data.LinkSdo).group,e=(0,z.j8)(t.data.LinkSdo).name;this.outputOptions[a][e].optional=!1}else if(!t.isUse&&t.isSame){this.output.data[i]=t.data,this.output.data[i].StartByte=null,this.output.names[i]="";let a=(0,z.j8)(t.data.LinkSdo).group,e=(0,z.j8)(t.data.LinkSdo).name;this.outputOptions[a][e].optional=!0}else t.isUse||t.isSame||(this.output.data[i]=t.data,this.outputOptions[n][o].optional=!0,this.output.data[i].StartByte=null,this.output.names[i]="")})).catch((t=>{console.log(t)}))},submitIoData(){this.isAllowLeave=!0,(0,P.jy)(this.ioData).then((t=>{if(0==t.status){let t=K.Z.global.t("dbgio.uploadSuc");F.c.success([t])}else{let t=K.Z.global.t("dbgio.uploadErr");F.c.error([t])}})).catch((()=>{let t=K.Z.global.t("dbgio.uploadErr");F.c.error([t])}))},isShow(t,i){if(0==t)return this.input.data[i]&&this.input.data[i]["Not"]},async getIoData(){this.ioData={ToolIn:{ByteLength:1,Member:[]},ToolOut:{ByteLength:1,Member:[]}},this.oldData=(0,A.p$)(this.ioData),await(0,P.yq)().then((t=>{if(0==t.status){if(t.data.ToolIn.Member)for(let i of t.data.ToolIn.Member)(0,z.ap)(i.LinkSdo)&&this.ioData.ToolIn.Member.push(i);if(t.data.ToolOut.Member)for(let i of t.data.ToolOut.Member)(0,z.j8)(i.LinkSdo)&&this.ioData.ToolOut.Member.push(i);this.initIoOptional()}else this.isServerChangeData=!1,F.c.error(["获取IO数据失败"])})).catch((()=>{this.isServerChangeData=!1}))},initMemberData(){this.input.data=Array(8).fill((0,A.p$)(this.inputMember)),this.output.data=Array(8).fill((0,A.p$)(this.outputMember))},initOptions(){this.inputOptions=(0,z.v7)(),this.outputOptions=(0,z.Ai)()},initIoOptional(){for(let t in this.ioData.ToolIn.Member){let i=this.ioData.ToolIn.Member[t],a=i.StartByte;if(null==a)continue;a=parseFloat(a.toFixed(1)),this.input.data[10*a]=(0,A.p$)(i);let e=(0,z.ap)(i.LinkSdo).group,s=(0,z.ap)(i.LinkSdo).name;this.input.names[10*a]=s,this.inputOptions[e][s].optional=!1}for(let t in this.ioData.ToolOut.Member){let i=this.ioData.ToolOut.Member[t],a=i.StartByte;if(null==a)continue;a=parseFloat(a.toFixed(1)),this.output.data[10*a]=(0,A.p$)(i);let e=(0,z.j8)(i.LinkSdo).group,s=(0,z.j8)(i.LinkSdo).name;this.output.names[10*a]=s,this.outputOptions[e][s].optional=!1}this.oldData=(0,A.p$)(this.ioData),this.isServerChangeData=!1},getToServerIoData(){let t=[],i=[];for(let a of this.input.data)null!=a.StartByte&&t.push(a);for(let a of this.output.data)null!=a.StartByte&&i.push(a);return this.ioData.ToolIn.Member=t,this.ioData.ToolOut.Member=i,this.ioData}},created(){this.initMemberData(),this.initOptions(),this.getIoData()},beforeRouteLeave(t,i,a){if(this.isAllowLeave||this.$store.state.g_status.busy)a();else{let t=this.$t("setcontrol.saveSet"),i=this.$t("setcontrol.yes"),e=this.$t("setcontrol.no"),s=this.$t("setcontrol.isSaveSet");(0,J.Z)({title:t,confirmText:i,cancelText:e,msg:s}).then((()=>{this.submitIoData(),setTimeout((()=>{a()}),100)})).catch((t=>{a()}))}},computed:{enabled(){return this.module in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.module]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.5}},watch:{input:{deep:!0,handler:function(){this.isServerChangeData||(this.oldData,this.getToServerIoData(),this.isAllowLeave=(0,A.IK)(this.oldData,this.getToServerIoData(),!0))}},output:{deep:!0,handler:function(){this.isServerChangeData||(this.isAllowLeave=(0,A.IK)(this.oldData,this.getToServerIoData(),!0))}}}},tt=()=>{(0,n.sj)((t=>({72575150:t.pointerEvent,"169c5ba0":t.opacity})))},it=X.setup;X.setup=it?(t,i)=>(tt(),it(t,i)):tt;var at=X;const et=(0,G.Z)(at,[["render",k],["__scopeId","data-v-0859b8be"]]);var st=et}}]);
//# sourceMappingURL=866.c7aac17b.js.map