{"version":3,"file":"js/794.23ddb8d2.js","mappings":"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","sources":["webpack://leetx-web/./src/components/debug/DebugInput.vue","webpack://leetx-web/./src/components/debug/DebugInput.vue?8548"],"sourcesContent":["<template>\r\n    <div class=\"input-box\">\r\n        <table class=\"input-table\">\r\n                <tr>\r\n                <td class=\"row1\">{{ $t('dbgtln.address') }}</td>\r\n                <td class=\"row2\">{{ $t('dbgtln.function') }}</td>\r\n                <td class=\"row3\">{{ $t('dbgtln.type') }}</td>\r\n                <td class=\"row4\">{{ $t('dbgtln.monitorvalue') }}</td>\r\n                <!-- <td>{{$t('dbgtln.modifiedvalue')}}</td>\r\n                <td>{{$t('dbgtln.operate')}}</td> -->\r\n            </tr>\r\n            <tr v-for=\"(item, key) of totalLineData.ToolIn.Member\" :key=\"key\">\r\n                <td class=\"row1\">{{ item.StartByte.toFixed(1) }}</td>\r\n                <td class=\"row2\">{{ getInSdoItem(item.LinkSdo, \"name\") }}</td>\r\n                <td class=\"row3\">{{ getInSdoItem(item.LinkSdo, \"type\") }}</td>\r\n                <td class=\"row4\">{{\r\n                    item.type == 10 || item.type == 11 ? parseFloat(realVals[item.LinkSdo]).toFixed(3) :\r\n                    realVals[item.LinkSdo]\r\n                }}</td>\r\n                <!-- <td>\r\n                    <InputText v-show=\"item['type']=='String'\" class=\"chng-val\" fntSize=\"1.5rem\"  width=\"6rem\" height=\"2.8rem\"></InputText>\r\n                    <InputVal v-show=\"item['type']=='Num'\" class=\"chng-val\" fntSize=\"1.5rem\"  width=\"6rem\" height=\"2.8rem\"></InputVal>\r\n                    <LeetxSwitch v-show=\"item['type']=='Bool'\" class=\"chng-swicth\" :height=\"2\"></LeetxSwitch>\r\n                </td>\r\n                <td>\r\n                    <Submit width=\"100%\" height=\"3rem\" class=\"must-btn\" @click=\"operateTotalline(key)\" :text=\"$t('dbgtln.mandatory')\"></Submit>\r\n                </td> -->\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { busFiledbusModifyApi, busFieldbusCfgUploadApi } from '@/api/io/io'\r\nimport { fileBusWebsocket } from '@/api/websocketApi'\r\nimport setRequiredSignal from \"@/dialogs/debug/IoMandatory/ioMandatory\"\r\nimport { maskApi } from '@/dialogs/mask/StackMask.vue'\r\nimport { getWhoSdoItems } from '@/dialogs/settings/fieldbus/fieldbusDefine'\r\n\r\nexport default {\r\n    // components:{InputText,Submit,LeetxSwitch,InputVal},\r\n    data() {\r\n        return {\r\n            totalLineData: {\r\n                \"Type\": \"FieldBus\",\r\n                \"NumeralByteOrder\": \"DCBA\",\r\n                \"StringByteOrder\": \"ABCD\",\r\n                \"NodeName\": \"\",\r\n                \"ToolIn\": {\r\n                    \"ByteLength\": 20,\r\n                    \"Member\": [\r\n                    ]\r\n                },\r\n                \"ToolOut\": {\r\n                    \"ByteLength\": 20,\r\n                    \"Member\": [\r\n                    ]\r\n                }\r\n            },\r\n            sdoItems: {},\r\n            connection: undefined,\r\n            realVals: {},\r\n            timerid: undefined,\r\n        }\r\n    },\r\n    methods: {\r\n        setSignal() {\r\n            const maskId = maskApi.rise(15)\r\n            setRequiredSignal().then(() => {\r\n                maskApi.descend(maskId)\r\n            }).catch(() => {\r\n                maskApi.descend(maskId)\r\n            });\r\n        },\r\n        operateTotalline(i) {\r\n            busFiledbusModifyApi({ 'addr': this.totalLineData.ToolIn.Member[i].StartByte, \"val\": true })\r\n        },\r\n        // 获取总线数据\r\n        getTotalLineData() {\r\n            busFieldbusCfgUploadApi().then((result) => {\r\n                if (result.data['Type'] == undefined) {\r\n                    let ToolIn = result.data.ToolIn\r\n                    if (!ToolIn) {\r\n                        ToolIn = {\r\n                            \"ByteLength\": 20,\r\n                            \"Member\": []\r\n                        }\r\n                    }\r\n                    this.totalLineData.ToolIn = ToolIn\r\n                    this.createWs()\r\n                } else {\r\n                    this.totalLineData = result.data\r\n                    this.createWs()\r\n                }\r\n            })\r\n        },\r\n        getAddress(address) {\r\n            return address.toFixed(1)\r\n        },\r\n        getInSdoItem(sdo, key) {\r\n            if (!sdo) { return \"--\" }\r\n            if (sdo in this.sdoItems.ToolIn && key in this.sdoItems.ToolIn[sdo]) {\r\n                return this.sdoItems.ToolIn[sdo][key]\r\n            }\r\n            return \"--\"\r\n        },\r\n        initSdoItems() {\r\n            this.sdoItems['ToolIn'] = getWhoSdoItems('in')\r\n        },\r\n        createWs() {\r\n            // 接收信息\r\n            fileBusWebsocket.msghandler = (msg) => {\r\n                this.realVals = JSON.parse(msg).data\r\n            }\r\n            // 是否连接上\r\n            fileBusWebsocket.openhandler = () => {\r\n                this.sendsdolst();\r\n            }\r\n            this.sendsdolst();\r\n        },\r\n\r\n        sendsdolst() {\r\n            let sdoList = this.getSdoList();\r\n            if (sdoList.length > 0) {\r\n                fileBusWebsocket.send(JSON.stringify({\r\n                    id: '0',\r\n                    mode: 'FIELDBUS',\r\n                    sdos: sdoList,\r\n                }));\r\n            }\r\n        },\r\n        getSdoList() {\r\n            let arr = []\r\n            let items = this.totalLineData.ToolIn.Member\r\n            for (let i = 0; i < items.length; i++) {\r\n                arr.push(items[i].LinkSdo)\r\n            }\r\n            return arr\r\n        },\r\n        // 获取IO数据\r\n        getFIELDBUSData() {\r\n            this.timerid = setInterval(() => {\r\n                this.dataId = Math.random();\r\n                fileBusWebsocket.send(\r\n                    JSON.stringify({ id: this.dataId, mode: \"FIELDBUS\" }))\r\n            }, 200);\r\n        },\r\n    },\r\n    created() {\r\n        // console.log('======input unmounted ');\r\n        this.getFIELDBUSData();\r\n        this.getTotalLineData();\r\n        this.initSdoItems();\r\n\r\n    },\r\n    unmounted() {\r\n        // console.log('input unmounted ================>');\r\n        clearInterval(this.timerid);\r\n        fileBusWebsocket.openhandler = null;\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.input-box {\r\n    position: relative;\r\n    height: 100%;\r\n    width: 100%;\r\n    overflow: hidden;\r\n    height: 65vh;\r\n    overflow-y: scroll;\r\n    overflow-x: hidden;\r\n}\r\n\r\n.input-table {\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    font-size: 1.375rem;\r\n    border-bottom: 2px solid var(--C00);\r\n}\r\n\r\n.input-table tr {\r\n    display: flex;\r\n    height: 4.9063vh;\r\n    width: 95vw;\r\n    color: var(--C00);\r\n    font-size: var(--font1_625);\r\n    border-bottom: 2px solid var(--CD4);\r\n}\r\n\r\n.input-table tr:last-child {\r\n    border: none;\r\n}\r\n\r\n.input-table tr:first-child {\r\n    color: var(--C3B);\r\n    font-size: var(--font1_5);\r\n    border-top: 2px solid var(--C00);\r\n    border-bottom: 1px solid var(--C00);\r\n}\r\n\r\n.input-table tr td {\r\n    position: relative;\r\n    top: 20%;\r\n    height: 2.6563vh;\r\n}\r\n\r\n.row1 {\r\n    width: 15%;\r\n}\r\n\r\n.row2 {\r\n    width: 40%;\r\n}\r\n\r\n.row3 {\r\n    width: 20%;\r\n}\r\n\r\n.row4 {\r\n    width: 25%;\r\n}\r\n\r\n.must-btn {\r\n    position: relative;\r\n    top: -22%;\r\n    cursor: pointer;\r\n    background-color: var(--C00c155);\r\n    border-radius: 5px;\r\n    box-shadow: 0px 1px 1px black;\r\n}\r\n\r\n.chng-val {\r\n    position: relative;\r\n    left: 50%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n}\r\n\r\n.chng-swicth {\r\n    position: relative;\r\n    left: 70%;\r\n    transform: translateX(-50%);\r\n}\r\n.td-type {\r\n    width: 7rem;\r\n    text-align: center;\r\n}\r\n#select-val {\r\n    width: 90%;\r\n    height: 2.9063vh;\r\n    font-size: var(--font1_5);\r\n    text-align: center;\r\n    border-radius: 4px;\r\n    background: var(--fff);\r\n    box-sizing: border-box;\r\n    border: 1px solid var(--C65);\r\n}\r\n</style>","import { render } from \"./DebugInput.vue?vue&type=template&id=3aa3274b&scoped=true\"\nimport script from \"./DebugInput.vue?vue&type=script&lang=js\"\nexport * from \"./DebugInput.vue?vue&type=script&lang=js\"\n\nimport \"./DebugInput.vue?vue&type=style&index=0&id=3aa3274b&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\Code\\\\Leetx\\\\web-screwdriver\\\\app\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3aa3274b\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_ctx","_hoisted_4","_hoisted_5","_hoisted_6","_Fragment","$data","ToolIn","Member","item","key","_hoisted_7","StartByte","toFixed","_hoisted_8","$options","LinkSdo","_hoisted_9","_hoisted_10","type","parseFloat","data","totalLineData","sdoItems","connection","undefined","realVals","timerid","methods","setSignal","maskId","maskApi","setRequiredSignal","then","catch","operateTotalline","i","busFiledbusModifyApi","this","getTotalLineData","busFieldbusCfgUploadApi","result","createWs","getAddress","address","getInSdoItem","sdo","initSdoItems","getWhoSdoItems","fileBusWebsocket","msg","JSON","parse","sendsdolst","sdoList","getSdoList","length","stringify","id","mode","sdos","arr","items","push","getFIELDBUSData","setInterval","dataId","Math","random","created","unmounted","clearInterval","__exports__","render"],"sourceRoot":""}