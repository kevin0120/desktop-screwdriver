"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[146],{99457:function(t,e,s){s.r(e),s.d(e,{default:function(){return T}});var i=s(66252),a=s(3577);const r=t=>((0,i.dD)("data-v-45424dd6"),t=t(),(0,i.Cn)(),t),o={class:"files-box"},n={class:"operate-line"},c=r((()=>(0,i._)("br",null,null,-1))),l=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),p=r((()=>(0,i._)("br",null,null,-1))),h=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),u=r((()=>(0,i._)("br",null,null,-1))),d=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),f=r((()=>(0,i._)("br",null,null,-1))),m={class:"items-box"},_=["onClick"],v={class:"file-name"},g={class:"add-box"};function $(t,e,s,r,$,P){const b=(0,i.up)("svg-loader"),w=(0,i.up)("LeetxButton");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",n,[(0,i._)("div",{class:"operate-box add-pf",onClick:e[0]||(e[0]=(...t)=>P.addPf&&P.addPf(...t))},[(0,i.Wm)(b,{class:"pfIcon",icon:"AddTwo",size:"2.5rem"}),c,(0,i._)("span",null,(0,a.zw)(t.$t("profile.add")),1)]),l,(0,i._)("div",{class:"operate-box activate-Pf",onClick:e[1]||(e[1]=(...t)=>P.activatePf&&P.activatePf(...t))},[(0,i.Wm)(b,{class:"pfIcon",icon:"RightOne",size:"2.5rem"}),p,(0,i._)("span",null,(0,a.zw)(t.$t("profile.activate")),1)]),h,(0,i._)("div",{class:"operate-box edit-pf",onClick:e[2]||(e[2]=(...t)=>P.editPf&&P.editPf(...t))},[(0,i.Wm)(b,{class:"pfIcon",icon:"EditTwo",size:"2.5rem"}),u,(0,i._)("span",null,(0,a.zw)(t.$t("profile.editor")),1)]),d,(0,i._)("div",{class:"operate-box delete-box",onClick:e[3]||(e[3]=(...t)=>P.delPf&&P.delPf(...t))},[(0,i.Wm)(b,{class:"pfIcon",icon:"TrashOne",size:"2.5rem"}),f,(0,i._)("span",null,(0,a.zw)(t.$t("profile.delete")),1)])]),(0,i._)("div",m,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)($.pfList.length,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"profile-item",onClick:e=>P.selectFile(t-1)},[(0,i.Wm)(b,{class:(0,a.C_)({"file-static-icon":!0,"file-active-icon":$.active_item==t-1}),icon:$.active_item==t-1?"ActivePf":"StaticPf",size:"10.5rem"},null,8,["class","icon"]),(0,i._)("span",{class:(0,a.C_)({"pf-static-num":!0,"pf-active-num":$.active_item==t-1})},(0,a.zw)(P.getPfNum(t)),3),(0,i._)("span",v,(0,a.zw)($.pfList[t-1]["name"]),1)],8,_)))),128)),(0,i._)("div",g,[(0,i.Wm)(w,{module:$.module,onClick:P.addPf,class:"file-static-icon",borderRadius:"0","use-icon":!0,icon:"AddTwo",bgcColor:"transparent",iconSize:"2.5rem"},null,8,["module","onClick"])])])])}var P=s(74125),b=s(84965),w=s(32015),L=s(33506),y=s(10335),k=s(22805),x=s(49963);const C={components:{LeetxButton:y.Z},data(){return{module:"PROFILE",pstmodule:"SELPSET",pfList:[],active_item:-1}},methods:{getPfNum(t){let e=this.pfList[t-1].mode,s=this.pfList[t-1].pset;switch(e){case 1:return s<10?`F0${s}`:`F${s}`;case 2:return s<10?`E0${s}`:`E${s}`;default:break}},delPf(){if(-1==this.active_item)return void b.c.error([this.$t("promsg.nselect_file")]);let t=this.pfList[this.active_item].pset;if(t==this.activatePset){let t=this.$t("promsg.no_delete");return void b.c.warning([t])}let e=`${this.$t("promsg.is_del")}${this.pfList[this.active_item].pset}`;this.$route.path.startsWith("/profile")&&this.$route.query&&this.$route.query.pset==t&&(e=this.$t("promsg.deleteFileEditing")),(0,w.Z)({title:this.$t("promsg.del"),confirmText:this.$t("promsg.yes"),cancelText:this.$t("promsg.no"),msg:e}).then((()=>{(0,P.rz)({pset:this.pfList[this.active_item].pset}).then((e=>{this.$bus.emit("delPset",{pset:t}),9130!=e.status?9125!=e.status?0==e.status?(this.$route.path.startsWith("/profile")&&this.$route.query&&this.$route.query.pset==t&&this.$router.push({path:this.$route.path,query:{pset:-1}}),this.operateFile({action:"sub"}),b.c.success([this.$t("promsg.del_suc")])):b.c.warning([this.$t("promsg.nexit"),this.$t("promsg.has_del")]):b.c.warning(["文件不存在或已经删除"]):b.c.error(["删除失败"])})).catch((()=>{b.c.error(["删除失败"]),this.operateFile({action:"sub"})})),this.active_item=-1}))},addPf(){(0,L.Z)({pfList:this.pfList}).then((t=>{let e=t.pset;(0,P.cy)(t.Profile).then((s=>{9121!=s.status?9123!=s.status?(0==s.status?t.Profile.Profile.Mode in k.lK?this.$router.push({path:k.lK[t.Profile.Profile.Mode],query:{pset:e}}):this.$router.push({path:"/profile",query:{pset:e}}):b.c.error([this.$t("promsg.add_fail")]),this.operateFile({action:"add"})):b.c.warning(["文件写入数据库失败"]):b.c.warning(["Pset或文件名重复"])})).catch((()=>{b.c.error([this.$t("promsg.add_fail")]),this.operateFile({action:"add"})}))}))},sortBy(t){return function(e,s){return e[t]-s[t]}},editPf(){if(-1==this.active_item)return void b.c.error([this.$t("promsg.nselect_file")]);let t=this.pfList[this.active_item];t.mode in k.lK?this.$router.push({path:k.lK[t.mode],query:{pset:t.pset}}):this.$router.push({path:"/profile",query:{pset:t.pset}}),this.operateFile({action:"edit"})},activatePf(){if(1!=this.$store.state.g_status.psetsrc){let t=this.$t("promsg.msgOne"),e=this.$t("promsg.msgTwo");return void b.c.warning([t,e])}if(-1==this.active_item)return void b.c.error([this.$t("promsg.nselect_file")]);if(this.pfList[this.active_item].pset==this.$store.state.g_status.pset)return void b.c.warning([this.$t("promsg.file_locate")]);if(this.$store.state.g_status.busy)return void b.c.warning([this.$t("promsg.run_status"),this.$t("promsg.nactivate_file")]);let t=this.pfList[this.active_item].pset;(0,P.TU)(t).then((t=>{9126!=t.status&&9129!=t.status?(0==t.status?b.c.success([this.$t("promsg.activate_suc")]):b.c.error("激活失败!"),this.operateFile({action:"activate"})):b.c.warning(["下位机切换文件失败"])})).catch((()=>{b.c.error([this.$t("promsg.activate_fail")]),this.operateFile({action:"activate"})}))},selectFile(t){this.active_item=t==this.active_item?-1:t},updateActiveItem(){let t=-1;for(let e=0;e<this.pfList.length;e++)if(this.pfList[e].pset==this.activatePset){t=e;break}this.active_item=t},getPfList(t){(0,P.Lm)().then((e=>{9127!=e.status&&0==e.status?(this.pfList=e.data.sort(this.sortBy("pset")),this.updateActiveItem(),t&&t()):this.pfList=[]})).catch((()=>{this.pfList=[]}))},operateFile(t){switch(t.action){case"add":this.showprofile_lst=!1,this.getPfList();break;case"sub":this.getPfList();break;case"edit":this.showprofile_lst=!1;break;case"close":this.showprofile_lst=!1;break}}},props:{fileItems:{type:Array,default:function(){return[]}}},watch:{fileItems:{immediate:!0,deep:!0,handler:function(){this.pfList=this.fileItems,this.pfList.sort(this.sortBy("pset"))}}},created(){this.getPfList()},unmounted(){},computed:{notAllowActivate(){return 1!=this.$store.state.g_status.psetsrc},activatePset(){return this.$store.state.g_status.pset},enabled(){return this.module in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.module]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.3},actEnable(){return this.pstmodule in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.pstmodule]},actPointerEvent(){return this.actEnable?"auto":"none"},actOpacity(){return this.actEnable?1:.3}}},E=()=>{(0,x.sj)((t=>({"0e8c8e10":t.actPointerEvent,"081dec90":t.actOpacity,"335943d8":t.pointerEvent,"383ef418":t.opacity})))},F=C.setup;C.setup=F?(t,e)=>(E(),F(t,e)):E;var z=C,I=s(83744);const q=(0,I.Z)(z,[["render",$],["__scopeId","data-v-45424dd6"]]);var T=q}}]);
//# sourceMappingURL=146.1c73f43a.js.map