"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[837],{3185:function(t,e,i){i.d(e,{I0:function(){return a},Lk:function(){return l},YL:function(){return n},i:function(){return o},v3:function(){return r}});var s=i(11586);function o(t){return(0,s.Z)({url:"pf/jobmod",method:"post",data:t})}function n(t){return(0,s.Z)({url:`pf/cur/job?id=${t}`,method:"get"})}function l(){return(0,s.Z)({url:"pf/cur/joblst",method:"get"})}function a(t){return(0,s.Z)({url:"pf/jobdel",method:"post",params:t})}function r(t){return(0,s.Z)({url:`pf/cur/jobsel?job=${t}`,method:"get"})}},59317:function(t,e,i){function s(t){let e;if(t instanceof Array){e=[];for(let i=0;i<t.length;i++)e[i]=s(t[i])}else if(t instanceof Object){e={};for(let i of Object.keys(t))e[i]=s(t[i])}else e=t;return e}function o(t,e,i=!1){let s=!0;if(t instanceof Array&&e instanceof Array&&e.length==t.length){for(let n=0;n<t.length;n++)if(s=s&&o(t[n],e[n],i),!s)break}else if(!(t instanceof Object&&e instanceof Object)||t instanceof Array||e instanceof Array)t instanceof Object||e instanceof Object?s=!1:(s=!0,i&&(s=t===e));else for(let n in t){if(!(n in e)){s=!1;break}if(s=s&&o(t[n],e[n],i),!s)break}return s}function n(t,e,i=!1){return i?JSON.stringify(t)===JSON.stringify(e):o(t,e)}i.d(e,{IK:function(){return n},p$:function(){return s}})},85837:function(t,e,i){i.r(e),i.d(e,{default:function(){return at}});var s=i(66252),o=i(3577);const n=t=>((0,s.dD)("data-v-47e5b932"),t=t(),(0,s.Cn)(),t),l={class:"tech-box"},a={class:"tech-basemsg-line"},r={class:"job-name-title"},h=n((()=>(0,s._)("div",{class:"job-options-box_line_top1"},null,-1))),c={class:"tech-basemsg-line"},u={class:"tech-num-3"},m={class:"tech-num-top"},d=n((()=>(0,s._)("div",{class:"job-options-box_line_top2"},null,-1))),f={class:"tech-basemsg-line"},_={class:"tech-num-3"},b={class:"tech-num-top"},p=n((()=>(0,s._)("div",{class:"job-options-box_line_top3"},null,-1))),g={class:"operate-line"},v=n((()=>(0,s._)("br",null,null,-1))),j=n((()=>(0,s._)("div",null,[(0,s._)("span",{class:"line"})],-1))),S=n((()=>(0,s._)("br",null,null,-1))),J=n((()=>(0,s._)("div",null,[(0,s._)("span",{class:"line"})],-1))),N=n((()=>(0,s._)("br",null,null,-1))),P={class:"delete-span"},w=n((()=>(0,s._)("div",{class:"job-options-box_line_top4"},null,-1))),I={key:0,class:"job-options-box"},$={key:0,class:"job-options-box_line1"},y=n((()=>(0,s._)("div",{class:"job-options-box_f"},"&",-1))),C=n((()=>(0,s._)("div",{class:"job-options-box_line2"},null,-1))),x=["onClick"],O={class:"pf-static-num"},k={class:"file-name"},R={key:1,class:"pro-step-data"},V={class:"tech-basemsg-line"},A=n((()=>(0,s._)("span",{class:"tech-pset"},"Pset",-1))),z={class:"tech-basemsg-line"},L={class:"tech-num"},M={class:"tech-basemsg-line"},F={class:"tech-num"},D={class:"tech-num-2"},Z={class:"tech-basemsg-line"},W={class:"tech-num"},B={class:"tech-num-2"};function E(t,e,i,n,E,G){const K=(0,s.up)("InputText"),T=(0,s.up)("LeetxSwitch"),U=(0,s.up)("InputVal"),q=(0,s.up)("svg-loader"),Y=(0,s.up)("NewSelect"),H=(0,s.up)("LeetxButton");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",a,[(0,s._)("span",r,"JOB "+(0,o.zw)(E.JobId.toString().padStart(3,"0"))+" "+(0,o.zw)(this.$t("job.edit")),1)]),h,(0,s._)("div",c,[(0,s._)("span",u,(0,o.zw)(this.$t("job.jobName")),1),(0,s.Wm)(K,{module:E.module,class:"tech-input-top",width:"20vw",disabled:!0,text:E.Name,"onUpdate:modelValue":e[0]||(e[0]=t=>E.Name=t.text),textValid:""==G.nameReason,validReason:G.nameReason},null,8,["module","text","textValid","validReason"]),(0,s._)("span",m,(0,o.zw)(this.$t("job.autoChoose")),1),(0,s.Wm)(T,{class:"tech-input-2",module:E.module,value:E.AutoSelPset,activeVal:!0,staticVal:!1,height:2,onSentVal:e[1]||(e[1]=t=>E.AutoSelPset=t)},null,8,["module","value"])]),d,(0,s._)("div",f,[(0,s._)("span",_,(0,o.zw)(this.$t("job.ngCount")),1),(0,s.Wm)(U,{minNum:0,maxNum:9999,module:E.module,sensorValue:E.MaxNGCount,width:"10rem",class:"tech-input-3","onUpdate:sensorValue":e[2]||(e[2]=t=>E.MaxNGCount=t)},null,8,["module","sensorValue"]),(0,s._)("span",b,(0,o.zw)(this.$t("job.reused")),1),(0,s.Wm)(T,{module:E.module,value:E.Reused,activeVal:!0,staticVal:!1,height:2,class:"tech-input-4",onSentVal:e[3]||(e[3]=t=>E.Reused=t)},null,8,["module","value"])]),p,(0,s._)("div",g,[(0,s._)("div",{class:"operate-box-stroke",onClick:e[4]||(e[4]=(...t)=>G.addParallelPf&&G.addParallelPf(...t))},[(0,s.Wm)(q,{class:"pfIcon",icon:"Addparallel",size:"2.5rem"}),v,(0,s._)("span",null,(0,o.zw)(this.$t("job.parallelAdd")),1)]),j,(0,s._)("div",{class:"operate-box-stroke",onClick:e[5]||(e[5]=(...t)=>G.addSerialPf&&G.addSerialPf(...t))},[(0,s.Wm)(q,{class:"pfIcon",icon:"Addserial",size:"2.5rem"}),S,(0,s._)("span",null,(0,o.zw)(this.$t("job.serialAdd")),1)]),J,(0,s._)("div",{class:"operate-box",onClick:e[6]||(e[6]=(...t)=>G.deletePf&&G.deletePf(...t))},[(0,s.Wm)(q,{class:"pfIcon",icon:"TrashOne",size:"2.5rem"}),N,(0,s._)("span",P,(0,o.zw)(this.$t("job.delete")),1)])]),w,0!=E.JobItems.length?((0,s.wg)(),(0,s.iD)("div",I,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(E.JobItems,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"job-options-box_1"},[e?((0,s.wg)(),(0,s.iD)("div",$)):(0,s.kq)("",!0),y,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t,((t,i)=>((0,s.wg)(),(0,s.iD)("div",{key:i,class:"job-options-box_2"},[C,(0,s._)("div",{class:(0,o.C_)({"job-options-box_4":!0,"job-options-box_4_active":E.active_item_i==e&&E.active_item_j==i}),onClick:t=>G.selectFile(e,i)},[(0,s.Wm)(q,{class:(0,o.C_)({"file-static-icon":!0}),icon:E.active_item_i==e&&E.active_item_j==i?"ActiveJob":"StaticJob"},null,8,["icon"]),(0,s._)("span",O,(0,o.zw)(t.Pset),1),(0,s._)("span",k,(0,o.zw)(this.$t("job.num"))+"ï¼š"+(0,o.zw)(t.BatchSize),1)],10,x)])))),128))])))),128))])):(0,s.kq)("",!0),-1!=E.curJobId?((0,s.wg)(),(0,s.iD)("div",R,[(0,s._)("div",V,[A,(0,s.Wm)(Y,{isScroll:!0,bottom:!0,width:36.5,module:E.module,realVal:G.currentPset.Pset,isAllowChng:!0,class:"tech-input-1",fontSize:"1.25rem",options:E.profileOptionNameLst,onValChng:e[7]||(e[7]=t=>G.setParams("Pset",t))},null,8,["width","module","realVal","options"])]),(0,s._)("div",z,[(0,s._)("span",L,(0,o.zw)(this.$t("job.num")),1),(0,s.Wm)(U,{maxNum:9999,minNum:1,module:E.module,sensorValue:G.currentPset.BatchSize,fontSize:"1.25rem",width:"13.5rem",class:"tech-input-1",onUpdateData:e[8]||(e[8]=t=>G.setParams("BatchSize",t.sensorValue))},null,8,["module","sensorValue"])]),(0,s._)("div",M,[(0,s._)("span",F,(0,o.zw)(this.$t("job.okCount")),1),(0,s.Wm)(Y,{bottom:!0,fntSize:"1.25rem",valLeft:"-0.3rem",module:E.module,width:13.5,realVal:G.currentPset.OnlyCntOK,isAllowChng:!0,class:"tech-input-1",options:E.okCountOpt,onValChng:e[9]||(e[9]=t=>G.setParams("OnlyCntOK",t))},null,8,["module","width","realVal","options"]),(0,s._)("span",D,(0,o.zw)(this.$t("job.reverseAng")),1),(0,s.Wm)(U,{module:E.module,class:"tech-input",maxNum:500,minNum:0,height:"3.125rem",fontSize:"1.25rem",width:"12rem",uname:"angle",showUnitName:!1,sensorValue:G.currentPset.ReverseOk,"onUpdate:sensorValue":e[10]||(e[10]=t=>G.currentPset.ReverseOk=t)},null,8,["module","sensorValue"])]),(0,s._)("div",Z,[(0,s._)("span",W,(0,o.zw)(this.$t("job.inReduceCount")),1),(0,s.Wm)(Y,{bottom:!0,module:E.module,width:13.5,realVal:G.currentPset.DecLoosening,isAllowChng:!0,fntSize:"1.25rem",valLeft:"-0.3rem",class:"tech-input-1",options:E.inReduceCount,onValChng:e[11]||(e[11]=t=>G.setParams("DecLoosening",t))},null,8,["module","width","realVal","options"]),(0,s._)("span",B,(0,o.zw)(this.$t("job.reverseMode")),1),(0,s.Wm)(Y,{bottom:!0,module:E.module,width:12,realVal:G.currentPset.LooseningMode,isAllowChng:!0,fntSize:"1.25rem",valLeft:"-0.3rem",class:"tech-input",options:E.reverseMode,onValChng:e[12]||(e[12]=t=>G.setParams("LooseningMode",t))},null,8,["module","realVal","options"])])])):(0,s.kq)("",!0),(0,s.Wm)(H,{module:E.module,width:"30.3125rem",height:"3.75rem",onClick:G.confirm,textColor:"#fff",text:t.$t("knowhat.save"),fontFamily:"'SourceHanSansCN-Bold'",fontSize:"2.25rem",bgcColor:"#00c155",class:"confirm-box"},null,8,["module","onClick","text"])])}var G=i(59317),K=i(22805),T=i(23263),U=i(22213),q=i(96799),Y=i(84965),H=i(3185),Q=i(74125),X=i(32015),tt=i(49963);const et={components:{NewSelect:q.Z,InputText:T.Z,InputVal:U.Z},data(){return{module:"PROFILE",profile:{},curJobId:-1,need_check_edit:!1,delPsetNum:0,profileNameLst:[],defaultPset:{Pset:0,RetriesLimit:!0,Retries:1,BatchSizeLimit:!0,BatchSize:10,LooseningMode:0,OnlyCntOK:1,ForceBatchStatus:0,DecLoosening:0,ReverseOk:0},profileOptionNameLst:{0:0},active_item_i:0,active_item_j:0,Name:"job1",JobId:1,Descr:"",Ver:"1.0.0",Mode:1,Reused:!0,JobSelSource:0,AutoSelPset:!1,MaxNGCount:10,global_json_name:"",global_json_maxNg:"",global_json_AutoSelPsetg:"",global_json_reused:"",global_job_params_data:"",JobItems:[],verifyZero:!0,okCountOpt:{},inReduceCount:{},reverseMode:{}}},beforeRouteLeave(t,e,i){if(this.saveVerify(),!this.verifyZero)return Y.c.warning([this.$t("job.psetNumNoZero")]),void i(!1);if(""!=this.nameReason&&-1!=this.curPsetId)return Y.c.warning([this.$t("job.invalidName")]),void i(!1);let s=this.global_job_params_data==JSON.stringify(this.profile),o=this.global_json_name==JSON.stringify(this.Name),n=this.global_json_maxNg==JSON.stringify(this.MaxNGCount),l=this.global_json_AutoSelPsetg==JSON.stringify(this.AutoSelPset),a=this.global_json_reused==JSON.stringify(this.Reused);if(s&&o&&n&&l&&a)i();else{let t=this.$t("setcontrol.saveSet"),e=this.$t("setcontrol.yes"),s=this.$t("setcontrol.no"),o=this.$t("setcontrol.isSaveSet");(0,X.Z)({title:t,confirmText:e,cancelText:s,msg:o}).then((()=>{this.confirm(),i()})).catch((()=>{i()}))}},methods:{initOptions(){let t=this.$t("job.allCount"),e=this.$t("job.okCount"),i=this.$t("job.inReduceCount"),s=this.$t("job.neverReduceCount"),o=this.$t("job.inOkReduceCount"),n=this.$t("job.neverReverse"),l=this.$t("job.allowReverse"),a=this.$t("job.nokReverse");this.okCountOpt={[t]:0,[e]:1},this.inReduceCount={[s]:0,[i]:1,[o]:2},this.reverseMode={[n]:0,[l]:1,[a]:2}},selectFile(t,e){this.active_item_i=t,this.active_item_j=e},setParams(t,e){this.JobItems[this.active_item_i][this.active_item_j][t]=e},setboolParams(t,e){this.JobItems[this.active_item_i][this.active_item_j][t]=e},addParallelPf(){this.JobItems[this.active_item_i].splice(this.active_item_j+1,0,(0,G.p$)(this.defaultPset)),this.active_item_j++},addSerialPf(){this.JobItems[this.active_item_i+1]=this.JobItems[this.active_item_i+1]?this.JobItems[this.active_item_i+1]:[],this.JobItems[this.active_item_i+1].unshift((0,G.p$)(this.defaultPset)),this.active_item_i++,this.active_item_j=0},deletePf(){const t=Math.max(this.active_item_i-1,0);this.JobItems[this.active_item_i].splice(this.active_item_j,1),0==this.JobItems[this.active_item_i].length?(this.JobItems.splice(this.active_item_i,1),this.active_item_i=t,this.active_item_j=0):this.active_item_j=Math.min(this.active_item_j,this.JobItems[this.active_item_i].length-1),0==this.JobItems.length&&(this.JobItems=[[(0,G.p$)(this.defaultPset)]],this.profile.JobItems=this.JobItems)},saveVerify(){for(let t=0;t<this.profile.JobItems.length;t++)for(let e=0;e<this.profile.JobItems[t].length;e++){const i=this.profile.JobItems[t][e].Pset;if(0===i)return this.verifyZero=!1,void Y.c.error([this.$t("job.psetNumNoZero")]);this.verifyZero=!0}},confirm(){if(""!=this.nameReason&&-1!=this.curPsetId)return void Y.c.warning([this.$t("job.invalidName")]);this.profile.Name=this.Name,this.profile.JobId=this.JobId,this.profile.Descr=this.Descr,this.profile.Ver=this.Ver,this.profile.Mode=this.Mode,this.profile.Reused=this.Reused,this.profile.JobSelSource=this.JobSelSource,this.profile.AutoSelPset=this.AutoSelPset,this.profile.MaxNGCount=this.MaxNGCount;let t=!0;for(let e=0;e<this.profile.JobItems.length;e++){let i=[];for(let s=0;s<this.profile.JobItems[e].length;s++){const o=this.profile.JobItems[e][s].Pset;if(0===o)return t=!1,this.verifyZero=!1,void Y.c.error([this.$t("job.psetNumNoZero")]);if(this.verifyZero=!0,i.includes(o))return t=!1,void Y.c.error([this.$t("job.noRepeat")]);i.push(o)}}this.need_check_edit=!1,t&&this.sendFileToServerApi(this.profile,this.saveSuccess)},backStaticBox(){this.activeBox=-1},sendFileToServerApi(t,e){if(!this.enabledEdit)return Y.c.warning([this.$t("tchnlgy.isRunning"),this.$t("tchnlgy.noModified")]);(0,H.i)({Profile:t}).then((t=>{this.need_check_edit=!1,e&&e(t)})).catch((t=>{console.log("pfModJobApi profile error ",t),Y.c.error([this.$t("job.saveFail")])}))},getFileContentByJobApi(t,e,i){(0,H.YL)(t).then((t=>{e&&e(t)})).catch((t=>{console.log("getFileContent profile error ",t),i&&i(t)}))},getCurJobProfile(t){t&&t>0&&this.getFileContentByJobApi(t,(e=>{if(0===e.status){let i=e.data.Profile;this.profile=i,this.setFileContent(i),this.curJobId=t,this.need_check_edit=!0,this.global_job_params_data=JSON.stringify(this.profile)}else this.curJobId=-1,this.need_check_edit=!1,Y.c.warning([this.$t("job.getFileFail")])}),(()=>{this.curJobId=-1,this.need_check_edit=!1,Y.c.warning([this.$t("job.getFileFail")])}))},setFileContent(t){this.profile=t,this.Name=this.profile.Name,this.Descr=this.profile.Descr,this.Ver=this.profile.Ver,this.Mode=this.profile.Mode,this.Reused=this.profile.Reused,this.JobSelSource=this.profile.JobSelSource,this.AutoSelPset=this.profile.AutoSelPset,this.MaxNGCount=this.profile.MaxNGCount,this.JobItems=this.profile.JobItems,this.global_json_name=JSON.stringify(this.Name),this.global_json_maxNg=JSON.stringify(this.MaxNGCount),this.global_json_AutoSelPsetg=JSON.stringify(this.AutoSelPset),this.global_json_reused=JSON.stringify(this.Reused)},initEmptyProfile(){this.profile=(0,K.mK)(2),this.setFileContent(this.profile)},excuteDefaultAction(){this.JobId=parseInt(this.$route.query.job),this.curJobId=this.JobId,this.curJobId>0&&this.getCurJobProfile(this.curJobId)},getPfList(t){(0,Q.Lm)().then((e=>{9127!=e.status&&0==e.status&&(this.profileNameLst=[],e.data.forEach((t=>{this.profileOptionNameLst[t.name]=t.pset})),t&&t())})).catch((()=>{}))},saveSuccess(t){0==t.status?(this.global_job_params_data=JSON.stringify(this.profile),this.global_json_name=JSON.stringify(this.Name),this.global_json_maxNg=JSON.stringify(this.MaxNGCount),this.global_json_AutoSelPsetg=JSON.stringify(this.AutoSelPset),this.global_json_reused=JSON.stringify(this.Reused),Y.c.success([this.$t("setop.saveSuc")])):9131==t.status?Y.c.warning([this.$t("tchnlgy.fileUnchanged")]):9125==t.status?Y.c.warning([this.$t("tchnlgy.fileNotExit")]):9128==t.status?Y.c.warning([this.$t("tchnlgy.versionInconsistent")]):9129==t.status?Y.c.warning([this.$t("tchnlgy.modifyFileFail")]):Y.c.error([this.$t("tchnlgy.saveFail"),[`[${t.status}]`]])},checkDelPfPset(){this.$bus.on("delPset",(t=>{this.delPsetNum=t.pset,this.profile}))}},computed:{currentPset(){return this.JobItems[this.active_item_i][this.active_item_j]},currentPsetlist(){return this.JobItems[this.active_item_i][this.active_item_j]},enabledEdit(){return 0==(this.curJobId==this.$store.state.g_status.pset&&this.$store.state.g_status.busy)},nameReason(){return-1==this.curJobId?-1:0==this.Name.length?this.$t("dlgprogram.nameNotEmpty"):this.Name&&this.profileNameLst.length>0&&-1!=this.profileNameLst.indexOf(this.Name)?this.$t("dlgprogram.nameRepeat"):""},enabled(){return"PROFILE"in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions["PROFILE"]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.5}},created(){this.getPfList(),this.initEmptyProfile(),this.checkDelPfPset(),this.initOptions()},watch:{"$route.query.job":{immediate:!0,handler:function(){this.excuteDefaultAction()}}}},it=()=>{(0,tt.sj)((t=>({e3255188:t.pointerEvent,"1de973cc":t.opacity})))},st=et.setup;et.setup=st?(t,e)=>(it(),st(t,e)):it;var ot=et,nt=i(83744);const lt=(0,nt.Z)(ot,[["render",E],["__scopeId","data-v-47e5b932"]]);var at=lt}}]);
//# sourceMappingURL=837.983ecf3d.js.map