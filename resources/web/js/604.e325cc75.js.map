{"version":3,"file":"js/604.e325cc75.js","mappings":"iMACSA,MAAM,a,GACAA,MAAM,e,GAEDA,MAAM,Q,GACNA,MAAM,Q,GACNA,MAAM,Q,GACNA,MAAM,Q,GAKNA,MAAM,Q,GACNA,MAAM,Q,GACNA,MAAM,Q,GACNA,MAAM,Q,0CAdtBC,EAAAA,EAAAA,IA4BE,MA5BFC,EA4BE,EA3BEC,EAAAA,EAAAA,GA0BQ,QA1BRC,EA0BQ,EAzBJD,EAAAA,EAAAA,GAOK,YANDA,EAAAA,EAAAA,GAAgD,KAAhDE,GAAgD,QAA5BC,EAAAA,GAAG,mBAAD,IACtBH,EAAAA,EAAAA,GAAiD,KAAjDI,GAAiD,QAA7BD,EAAAA,GAAG,oBAAD,IACtBH,EAAAA,EAAAA,GAA6C,KAA7CK,GAA6C,QAAzBF,EAAAA,GAAG,gBAAD,IACtBH,EAAAA,EAAAA,GAAqD,KAArDM,GAAqD,QAAjCH,EAAAA,GAAG,wBAAD,oBAI1BL,EAAAA,EAAAA,IAgBKS,EAAAA,GAAAA,MAAAA,EAAAA,EAAAA,IAhBqBC,EAAAA,cAAcC,QAAQC,QAAM,CAA1CC,EAAMC,M,WAAlBd,EAAAA,EAAAA,IAgBK,MAhBoDc,IAAKA,GAAG,EAC7DZ,EAAAA,EAAAA,GAAqD,KAArDa,GAAqD,QAAjCF,EAAKG,UAAUC,QAAQ,IAAD,IAC1Cf,EAAAA,EAAAA,GAA+D,KAA/DgB,GAA+D,QAA3CC,EAAAA,cAAcN,EAAKO,QAAS,SAAF,IAC9ClB,EAAAA,EAAAA,GAA+D,KAA/DmB,GAA+D,QAA3CF,EAAAA,cAAcN,EAAKO,QAAS,SAAF,IAC9ClB,EAAAA,EAAAA,GAAmD,KAAnDoB,GAAmD,QAA/BH,EAAAA,UAAUN,EAAKO,UAAO,Q,qEAuB1D,GAEIG,OACI,MAAO,CACHC,cAAe,CACX,KAAQ,WACR,iBAAoB,OACpB,gBAAmB,OACnB,SAAY,GACZ,OAAU,CACN,WAAc,GACd,OAAU,IAGd,QAAW,CACP,WAAc,GACd,OAAU,KAIlBC,KAAK,EACLC,SAAU,CAAC,EACXC,SAAU,CAAC,EACXC,mBAAeC,EAEvB,EACAC,QAAS,CAKLC,UAAUC,GACN,GAAW,YAAPA,EACA,OAAOC,SAASC,KAAKP,SAASK,IAAMG,SAAS,MAAMC,SAAS,EAAG,KACnE,IAAIC,EAAOH,KAAKI,cAAcN,EAAK,QACnC,MAAY,OAARK,GAAyB,OAARA,EACVE,WAAWL,KAAKP,SAASK,IAAMf,QAAQ,GACtCiB,KAAKP,SAASK,EAC9B,EACAQ,YACI,MAAMC,EAASC,EAAAA,EAAAA,KAAa,KAC5BC,EAAAA,EAAAA,KAAoBC,MAAK,KACrBF,EAAAA,EAAAA,QAAgBD,EAAO,IACxBI,OAAM,KACLH,EAAAA,EAAAA,QAAgBD,EAAO,GAE/B,EACAK,iBAAiBC,IACbC,EAAAA,EAAAA,IAAqB,CAAE,KAAQd,KAAKV,cAAcb,QAAQC,OAAOmC,GAAG/B,UAAW,KAAO,GAC1F,EAEAiC,oBACIC,EAAAA,EAAAA,MAA0BN,MAAMO,IAC5B,QAA2BtB,GAAvBsB,EAAO5B,KAAK,QAAsB,CAClC,IAAIZ,EAAUwC,EAAO5B,KAAKZ,QACjBA,IAEDA,EAAS,CACL,WAAc,GACd,OAAU,KAGtBuB,KAAKV,cAAcb,QAAUA,EAC7BuB,KAAKkB,UACT,MACIlB,KAAKV,cAAgB2B,EAAO5B,KAC5BW,KAAKkB,UACT,IACDP,OAAM,QAEb,EACAQ,WAAWC,GAEX,EACAhB,cAAcN,EAAKlB,GACf,OAAKkB,GACDA,KAAOE,KAAKR,SAAS,YAAcZ,KAAOoB,KAAKR,SAAS,WAAWM,GAC5DE,KAAKR,SAAS,WAAWM,GAAKlB,GAFtB,IAKvB,EACAyC,eACIrB,KAAKR,SAAS,YAAa8B,EAAAA,EAAAA,IAAe,MAC9C,EACAJ,WACIK,EAAAA,GAAAA,WAA+BC,IAC3BxB,KAAKP,SAAWgC,KAAKC,MAAMF,GAAKnC,IAAG,EAGvCkC,EAAAA,GAAAA,YAA+B,KAC3BvB,KAAK2B,YAAY,EAGrB3B,KAAK2B,YACT,EACAA,aACI,IAAIC,EAAU5B,KAAK6B,aACfD,EAAQE,QAAU,GAClBP,EAAAA,GAAAA,KAAsBE,KAAKM,UAAU,CACjCC,GAAI,IACJC,KAAM,WACNC,KAAMN,IAIlB,EACAC,aACI,IAAIM,EAAM,GACNC,EAAQpC,KAAKV,cAAcb,QAAQC,OACvC,IAAK,IAAImC,EAAI,EAAGA,EAAIuB,EAAMN,OAAQjB,IAC9BsB,EAAIE,KAAKD,EAAMvB,GAAG3B,SAEtB,OAAOiD,CACX,EAEAG,kBACItC,KAAKN,cAAgB6C,aAAY,KAC7BvC,KAAKwC,OAASC,KAAKC,SACnBnB,EAAAA,GAAAA,KACIE,KAAKM,UAAU,CACXC,GAAIhC,KAAKwC,OACTP,KAAM,aAEb,GACF,IACP,GAGJU,UACI3C,KAAKsC,kBACLtC,KAAKe,mBACLf,KAAKqB,cACT,EACAuB,YACIC,cAAc7C,KAAKN,eACnB6B,EAAAA,GAAAA,YAA+B,IACnC,G,WCvKJ,MAAMuB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://leetx-web/./src/components/debug/DebugOutput.vue","webpack://leetx-web/./src/components/debug/DebugOutput.vue?27f7"],"sourcesContent":["<template>\r\n    <div class=\"input-box\">\r\n        <table class=\"input-table\">\r\n            <tr>\r\n                <td class=\"row1\">{{ $t('dbgtln.address') }}</td>\r\n                <td class=\"row2\">{{ $t('dbgtln.function') }}</td>\r\n                <td class=\"row3\">{{ $t('dbgtln.type') }}</td>\r\n                <td class=\"row4\">{{ $t('dbgtln.monitorvalue') }}</td>\r\n                <!-- <td>{{$t('dbgtln.modifiedvalue')}}</td>\r\n                                                    <td>{{$t('dbgtln.operate')}}</td> -->\r\n            </tr>\r\n            <tr v-for=\"(item, key) of totalLineData.ToolOut.Member\" :key=\"key\">\r\n                <td class=\"row1\">{{ item.StartByte.toFixed(1) }}</td>\r\n                <td class=\"row2\">{{ getOutSdoItem(item.LinkSdo, \"name\") }}</td>\r\n                <td class=\"row3\">{{ getOutSdoItem(item.LinkSdo, \"type\") }}</td>\r\n                <td class=\"row4\">{{ formatval(item.LinkSdo) }}</td>\r\n                <!-- {{realVals}}\r\n                                                    {{item.LinkSdo}} -->\r\n                <!-- <td>{{item.LinkSdo}}</td> -->\r\n                <!-- <td>\r\n                                                        <InputText v-show=\"item['type']=='String'\" class=\"chng-val\" fntSize=\"1.5rem\"  width=\"6rem\" height=\"2.8rem\"></InputText>\r\n                                                        <InputVal v-show=\"item['type']=='Num'\" class=\"chng-val\" fntSize=\"1.5rem\"  width=\"6rem\" height=\"2.8rem\"></InputVal>\r\n                                                        <LeetxSwitch v-show=\"item['type']=='Bool'\" class=\"chng-swicth\" :height=\"2\"></LeetxSwitch>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <Submit width=\"100%\" height=\"3rem\" class=\"must-btn\" @click=\"operateTotalline(key)\" :text=\"$t('dbgtln.mandatory')\"></Submit>\r\n                                                    </td> -->\r\n            </tr>\r\n        </table>\r\n</div>\r\n</template>\r\n<script>\r\n// getWhoSdoItems\r\nimport { busFiledbusModifyApi, busFieldbusCfgUploadApi } from '../../api/io/io'\r\nimport { fileBusWebsocket } from '../../api/websocketApi'\r\nimport setRequiredSignal from \"../../dialogs/debug/IoMandatory/ioMandatory\"\r\nimport { maskApi } from '../../dialogs/mask/StackMask.vue'\r\nimport { getWhoSdoItems } from '../../dialogs/settings/fieldbus/fieldbusDefine'\r\nexport default {\r\n    // components:{InputText,Submit,LeetxSwitch,InputVal},\r\n    data() {\r\n        return {\r\n            totalLineData: {\r\n                \"Type\": \"FieldBus\",\r\n                \"NumeralByteOrder\": \"DCBA\",\r\n                \"StringByteOrder\": \"ABCD\",\r\n                \"NodeName\": \"\",\r\n                \"ToolIn\": {\r\n                    \"ByteLength\": 20,\r\n                    \"Member\": [\r\n                    ]\r\n                },\r\n                \"ToolOut\": {\r\n                    \"ByteLength\": 20,\r\n                    \"Member\": [\r\n                    ]\r\n                }\r\n            },\r\n            res: false,\r\n            sdoItems: {},\r\n            realVals: {},\r\n            FIELDBUSTimer: undefined,\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * 格式化总线值\r\n         * @param {*} sdo 绑定的sdo\r\n         */\r\n        formatval(sdo) {\r\n            if (sdo == \"0x30020B\")\r\n                return parseInt(this.realVals[sdo]).toString('16').padStart(4, '0')\r\n            let type = this.getOutSdoItem(sdo, \"type\")\r\n            if (type == \"F32\" || type == \"F64\")\r\n                return parseFloat(this.realVals[sdo]).toFixed(3)\r\n            else return this.realVals[sdo]\r\n        },\r\n        setSignal() {\r\n            const maskId = maskApi.rise(15)\r\n            setRequiredSignal().then(() => {\r\n                maskApi.descend(maskId)\r\n            }).catch(() => {\r\n                maskApi.descend(maskId)\r\n            });\r\n        },\r\n        operateTotalline(i) {\r\n            busFiledbusModifyApi({ 'addr': this.totalLineData.ToolOut.Member[i].StartByte, \"val\": true })\r\n        },\r\n        // 获取总线数据\r\n        getTotalLineData() {\r\n            busFieldbusCfgUploadApi().then((result) => {\r\n                if (result.data['Type'] == undefined) {\r\n                    let ToolOut = result.data.ToolOut\r\n                        if (!ToolOut)\r\n                        {\r\n                            ToolOut= {\r\n                                \"ByteLength\": 20,\r\n                                \"Member\": []\r\n                            }\r\n                        }\r\n                    this.totalLineData.ToolOut = ToolOut\r\n                    this.createWs()\r\n                } else {\r\n                    this.totalLineData = result.data\r\n                    this.createWs()\r\n                }\r\n            }).catch(() => {\r\n            });\r\n        },\r\n        getAddress(address) {\r\n            address\r\n        },\r\n        getOutSdoItem(sdo, key) {\r\n            if (!sdo) { return \"--\" }\r\n            if (sdo in this.sdoItems['ToolOut'] && key in this.sdoItems['ToolOut'][sdo]) {\r\n                return this.sdoItems['ToolOut'][sdo][key]\r\n            }\r\n            return \"--\"\r\n        },\r\n        initSdoItems() {\r\n            this.sdoItems['ToolOut'] = getWhoSdoItems('out')\r\n        },\r\n        createWs() {\r\n            fileBusWebsocket.msghandler = (msg) => {\r\n                this.realVals = JSON.parse(msg).data\r\n            }\r\n            // 是否连接上\r\n            fileBusWebsocket.openhandler = () => {\r\n                this.sendsdoLst();\r\n            }\r\n\r\n            this.sendsdoLst();\r\n        },\r\n        sendsdoLst() {\r\n            let sdoList = this.getSdoList()\r\n            if (sdoList.length >= 0) {\r\n                fileBusWebsocket.send(JSON.stringify({\r\n                    id: '0',\r\n                    mode: 'FIELDBUS',\r\n                    sdos: sdoList,\r\n                    // ori:\"out\"\r\n                }))\r\n            }\r\n        },\r\n        getSdoList() {\r\n            let arr = []\r\n            let items = this.totalLineData.ToolOut.Member\r\n            for (let i = 0; i < items.length; i++) {\r\n                arr.push(items[i].LinkSdo)\r\n            }\r\n            return arr\r\n        },\r\n        // 获取IO数据\r\n        getFIELDBUSData() {\r\n            this.FIELDBUSTimer = setInterval(() => {\r\n                this.dataId = Math.random();\r\n                fileBusWebsocket.send(\r\n                    JSON.stringify({\r\n                        id: this.dataId,\r\n                        mode: \"FIELDBUS\",\r\n                    })\r\n                );\r\n            }, 200);\r\n        },\r\n\r\n    },\r\n    created() {\r\n        this.getFIELDBUSData();\r\n        this.getTotalLineData();\r\n        this.initSdoItems();\r\n    },\r\n    unmounted() {\r\n        clearInterval(this.FIELDBUSTimer);\r\n        fileBusWebsocket.openhandler = null;\r\n    }\r\n\r\n}\r\n</script>\r\n<style scoped>\r\n.input-box {\r\n    position: relative;\r\n    height: 100%;\r\n    width: 100%;\r\n    overflow: hidden;\r\n    height: 65vh;\r\n    overflow-y: scroll;\r\n    overflow-x: hidden;\r\n}\r\n\r\n.input-table {\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    font-size: 1.375rem;\r\n    border-bottom: 2px solid var(--C00);\r\n}\r\n\r\n.input-table tr {\r\n    display: flex;\r\n    height: 4.9063vh;\r\n    width: 95vw;\r\n    color: var(--C00);\r\n    font-size: var(--font1_625);\r\n    border-bottom: 2px solid var(--CD4);\r\n}\r\n\r\n.input-table tr:last-child {\r\n    border: none;\r\n}\r\n\r\n.input-table tr:first-child {\r\n    color: var(--C3B);\r\n    font-size: var(--font1_5);\r\n    border-top: 2px solid var(--C00);\r\n    border-bottom: 1px solid var(--C00);\r\n}\r\n\r\n.input-table tr td {\r\n    position: relative;\r\n    top: 20%;\r\n    height: 2.6563vh;\r\n}\r\n\r\n.row1 {\r\n    width: 15%;\r\n}\r\n\r\n.row2 {\r\n    width: 40%;\r\n}\r\n\r\n.row3 {\r\n    width: 20%;\r\n}\r\n\r\n.row4 {\r\n    width: 25%;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n}\r\n\r\n.must-btn {\r\n    position: relative;\r\n    top: -22%;\r\n    cursor: pointer;\r\n    background-color: var(--C00c155);\r\n    border-radius: 5px;\r\n    box-shadow: 0px 1px 1px black;\r\n}\r\n\r\n.chng-val {\r\n    position: relative;\r\n    left: 50%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n}\r\n\r\n.chng-swicth {\r\n    position: relative;\r\n    left: 70%;\r\n    transform: translateX(-50%);\r\n}\r\n</style>","import { render } from \"./DebugOutput.vue?vue&type=template&id=1a2ccd0e&scoped=true\"\nimport script from \"./DebugOutput.vue?vue&type=script&lang=js\"\nexport * from \"./DebugOutput.vue?vue&type=script&lang=js\"\n\nimport \"./DebugOutput.vue?vue&type=style&index=0&id=1a2ccd0e&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\Code\\\\Leetx\\\\web-screwdriver\\\\app\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1a2ccd0e\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_ctx","_hoisted_4","_hoisted_5","_hoisted_6","_Fragment","$data","ToolOut","Member","item","key","_hoisted_7","StartByte","toFixed","_hoisted_8","$options","LinkSdo","_hoisted_9","_hoisted_10","data","totalLineData","res","sdoItems","realVals","FIELDBUSTimer","undefined","methods","formatval","sdo","parseInt","this","toString","padStart","type","getOutSdoItem","parseFloat","setSignal","maskId","maskApi","setRequiredSignal","then","catch","operateTotalline","i","busFiledbusModifyApi","getTotalLineData","busFieldbusCfgUploadApi","result","createWs","getAddress","address","initSdoItems","getWhoSdoItems","fileBusWebsocket","msg","JSON","parse","sendsdoLst","sdoList","getSdoList","length","stringify","id","mode","sdos","arr","items","push","getFIELDBUSData","setInterval","dataId","Math","random","created","unmounted","clearInterval","__exports__","render"],"sourceRoot":""}