"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[107],{59317:function(e,t,s){function o(e){let t;if(e instanceof Array){t=[];for(let s=0;s<e.length;s++)t[s]=o(e[s])}else if(e instanceof Object){t={};for(let s of Object.keys(e))t[s]=o(e[s])}else t=e;return t}function i(e,t,s=!1){let o=!0;if(e instanceof Array&&t instanceof Array&&t.length==e.length){for(let a=0;a<e.length;a++)if(o=o&&i(e[a],t[a],s),!o)break}else if(!(e instanceof Object&&t instanceof Object)||e instanceof Array||t instanceof Array)e instanceof Object||t instanceof Object?o=!1:(o=!0,s&&(o=e===t));else for(let a in e){if(!(a in t)){o=!1;break}if(o=o&&i(e[a],t[a],s),!o)break}return o}function a(e,t,s=!1){return s?JSON.stringify(e)===JSON.stringify(t):i(e,t)}s.d(t,{IK:function(){return a},p$:function(){return o}})},35084:function(e,t,s){s.d(t,{Z:function(){return h}});var o=s(66252),i=s(3577);function a(e,t,s,a,l,n){return(0,o.wg)(),(0,o.iD)("div",{class:(0,i.C_)(n.boxClass),onClick:t[0]||(t[0]=(...e)=>n.updateData&&n.updateData(...e))},null,2)}var l=s(48024),n=s(49963);const r={data(){return{status:!1}},methods:{updateData(){this.allowClick&&(this.status=!this.status,this.$emit("update:modelValue",this.status?this.activeValue:this.staticValue))},initData(){this.status=this.modelValue==this.activeValue}},props:{activeValue:{type:null,default:1},staticValue:{type:null,default:0},modelValue:{type:null,default:0},size:{type:String,default:"2rem"},width:{type:String,default:"1.5rem"},color:{type:String,default:"#c7c7c7"},allowClick:{type:Boolean,default:!0},isAllowUse:{type:Boolean,default:!0},module:{type:String,default:"NULL"}},computed:{boxClass(){return this.status?"active-box":"static-box"},enabled(){return!!this.isAllowUse&&("NULL"==this.module||this.module in l.G.state.f_status.permissions&&4==l.G.state.f_status.permissions[this.module])},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.5}},created(){this.initData()},watch:{modelValue(){this.initData()}}},d=()=>{(0,n.sj)((e=>({"58132bc8":e.width,"5a41288e":e.color,c8780d72:e.pointerEvent,"149276e1":e.opacity})))},c=r.setup;r.setup=c?(e,t)=>(d(),c(e,t)):d;var u=r,p=s(83744);const m=(0,p.Z)(u,[["render",a],["__scopeId","data-v-b341f6b8"]]);var h=m},61107:function(e,t,s){s.r(t),s.d(t,{default:function(){return re}});var o=s(66252),i=s(3577),a=s(49963);const l=e=>((0,o.dD)("data-v-6d029ea3"),e=e(),(0,o.Cn)(),e),n={class:"users-nav"},r=l((()=>(0,o._)("span",{class:"id"},"ID",-1))),d={class:"mask-box"},c={class:"table-box"},u=["onClick"],p={class:"id"},m={class:"rolename"},h={key:0,class:"edit"},g={class:(0,i.C_)({"users-item":!0,"add-line":!0})},v={key:0,class:"id"};function f(e,t,s,l,f,_){const w=(0,o.up)("svg-loader"),k=(0,o.up)("LeetxButton");return(0,o.wg)(),(0,o.iD)("div",{class:"users-mng-box",onClick:t[0]||(t[0]=(...t)=>e.isClickOpearteBox&&e.isClickOpearteBox(...t))},[(0,o._)("div",n,[r,(0,o._)("span",{class:"rolename",ref:"editUsr"},(0,i.zw)(e.$t("setrole.rolename")),513)]),(0,o._)("div",d,[(0,o._)("div",c,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(f.groups,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:(0,i.C_)({"users-item":!0,"active-user":f.actvRole==t}),onClick:e=>_.operateUsr(t)},[(0,o._)("span",p,(0,i.zw)(t+1),1),(0,o._)("span",m,(0,i.zw)(e.group_name),1),4==_.permision_level?((0,o.wg)(),(0,o.iD)("span",h,[(0,o.wy)((0,o.Wm)(w,{onClick:_.editRolePrmsns,class:"edit-btn",icon:"ActiveEditUser",size:"2.5rem"},null,8,["onClick"]),[[a.F8,f.actvRole==t]]),(0,o.wy)((0,o.Wm)(w,{onClick:_.delGroup,class:"trash-btn",icon:"DelDmrct",size:"2.5rem"},null,8,["onClick"]),[[a.F8,f.actvRole==t&&this.$store.state.f_status.group_id!=e.group_id]])])):(0,o.kq)("",!0)],10,u)))),128)),(0,o._)("div",g,[4==_.permision_level?((0,o.wg)(),(0,o.iD)("span",v,[(0,o.Wm)(k,{onClick:_.addRoleDialog,class:"add-btn","use-icon":!0,icon:"StaticCircleAdd",bgcColor:"transparent",height:"2.5rem",width:"2.5rem",iconSize:"2.5rem"},null,8,["onClick"])])):(0,o.kq)("",!0)])])])])}var _=s(69947);const w={key:0,class:"role-prmsns-box"},k={class:"prmsns-title-line"},b={class:"eidtuser-title-line"},C={class:"title-text"},y={class:"prmsn-role-person"},R={class:"prmsn-role-name"},x={class:"role-prmsns-list"},$={class:"role-prmsn-name div-width"},D=["onClick"],V={class:"div-checkbox"},I=["onClick"],S={class:"div-checkbox"};function z(e,t,s,l,n,r){const d=(0,o.up)("svgloader"),c=(0,o.up)("CheckCircle");return n.isShow?((0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("div",k,[(0,o._)("div",b,[(0,o._)("div",C,(0,i.zw)(e.$t("dlgpermisson.accessControl")),1),(0,o._)("span",{class:"edituser-box-close",onClick:t[0]||(t[0]=(...e)=>r.cancel&&r.cancel(...e))},[(0,o.Wm)(d,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,o._)("div",y,[(0,o.Wm)(d,{class:"prmsn-role-icon",icon:n.roleIcon,size:"2.5rem"},null,8,["icon"]),(0,o._)("div",R,(0,i.zw)(e.$t("dlgpermisson.role"))+"："+(0,i.zw)(s.group_name),1)]),(0,o._)("div",{class:"prmsns-cnfrm-btn",onClick:t[1]||(t[1]=(...e)=>r.updateRolePrmsns&&r.updateRolePrmsns(...e))},(0,i.zw)(e.$t("dlgpermisson.sure")),1)]),(0,o.wy)((0,o._)("div",x,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.trgtRolePrmsns.modules,((t,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"role-prmsn-item",key:s},[(0,o._)("div",$,(0,i.zw)(t.module_desc),1),(0,o._)("div",{class:(0,i.C_)(["role-prmsn-show",{blckColor:1==t.level}]),onClick:e=>t.level=1},(0,i.zw)(e.$t("dlgpermisson.visable")),11,D),(0,o._)("div",V,[(0,o.Wm)(c,{class:"checkbox",modelValue:t.level,"onUpdate:modelValue":e=>t.level=e,activeValue:1,staticValue:0},null,8,["modelValue","onUpdate:modelValue"])]),(0,o._)("div",{class:(0,i.C_)(["role-prmsn-edit",{blckColor:4==t.level}]),onClick:e=>t.level=4},(0,i.zw)(e.$t("dlgpermisson.operational")),11,I),(0,o._)("div",S,[(0,o.Wm)(c,{class:"checkbox",modelValue:t.level,"onUpdate:modelValue":e=>t.level=e,activeValue:4,staticValue:0},null,8,["modelValue","onUpdate:modelValue"])])])))),128))],512),[[a.F8,-1!=s.group_id]])])):(0,o.kq)("",!0)}var G=s(59317),P=s(73496),U=s(35084),O=s(84965),N=s(65884),T=s(48024),j={components:{svgloader:P.Z,CheckCircle:U.Z},data(){return{trgtRolePrmsns:{edituser:0,debug:0,manageSys:0,manageUsers:0},mdls:{},isShow:!0,roleIcon:"Worker",maskId:0}},methods:{updateRolePrmsns(){this.isShow=!1,this.modPrmsns(),this.onConfirm&&this.onConfirm(),N.g.descend(this.maskId)},cancel(){this.isShow=!1,this.onCancel&&this.onCancel(),N.g.descend(this.maskId)},getPrmsns(e){(0,_.E5)(e).then((e=>{0==e.status?this.trgtRolePrmsns=e.data:O.c.error(["获取用户组权限失败"])}))},async modPrmsns(){let e={};e["group_id"]=this.group_id,e["modules"]=(0,G.p$)(this.trgtRolePrmsns["modules"]),e["reload"]=T.G.state.f_status.group_id==this.group_id,await(0,_.HB)(e).then((e=>{T.G.state.f_status.group_id==this.group_id&&(e&&e.data?T.G.state.f_status.permissions=e.data:T.G.state.f_status.permissions={}),O.c.success(["更新成功"])})).catch((()=>{O.c.success(["更新失败"])}))},updateRole(){switch(this.group_id){case 1:this.roleIcon="Super";break;case 2:this.roleIcon="Admin";break;case 4:this.roleIcon="Engineer";break;default:this.roleIcon="Worker"}},initStatus(){this.maskId=N.g.rise(15,this.cancel)}},props:{group_name:{type:String,default:()=>(void 0).$t("dlgpermisson.worker")},group_id:{type:Number,default:1}},created(){this.getPrmsns(this.group_id),this.updateRole()},watch:{group_id:{immediate:!0,handler:function(){this.updateRole()}}},mounted(){this.initStatus()}},Z=s(83744);const L=(0,Z.Z)(j,[["render",z],["__scopeId","data-v-12479024"]]);var W=L,A=s(92797);const E=(e={})=>{if("object"!=typeof e)throw new Error("props must be a object");return new Promise(((t,s)=>{let o=(0,a.ri)(W,e).use(A.Z).mount(document.createElement("div"));document.body.appendChild(o.$el),o.onConfirm=function(e){t(e)},o.onCancel=function(){s()}}))};var B=E;const F={key:0,class:"addrole-box"},q={class:"addrole-title-line"},H={class:"addrole-title-msg"},K={class:"addrole-new-line"},J={class:"addrole-name-text"},Y={class:"addrole-operate-line"};function M(e,t,s,l,n,r){const d=(0,o.up)("svgloader"),c=(0,o.up)("InputText");return n.isShow?((0,o.wg)(),(0,o.iD)("div",F,[(0,o._)("div",q,[(0,o._)("span",H,(0,i.zw)(e.$t("newrole.newgroup")),1),(0,o._)("span",{class:"addrole-box-close",onClick:t[0]||(t[0]=(...e)=>r.cancel&&r.cancel(...e))},[(0,o.Wm)(d,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,o._)("div",K,[(0,o._)("div",J,(0,i.zw)(e.$t("newrole.groupname")),1),(0,o.Wm)(c,{fntFmly:"--R-M",imprprChrctr:["space"],class:"addrole-name-input",type:"text",modelValue:n.roleData.group_name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.roleData.group_name=e),textValid:r.roleNameValid,validReason:r.roleNameReason},null,8,["modelValue","textValid","validReason"])]),(0,o._)("div",Y,[(0,o._)("div",{class:"addrole-cancel-btn",onClick:t[2]||(t[2]=(...e)=>r.cancel&&r.cancel(...e))},(0,i.zw)(e.$t("newrole.cancel")),1),(0,o.wy)((0,o._)("div",{class:"addrole-cnfrm-btn",onClick:t[3]||(t[3]=(...e)=>r.addRole&&r.addRole(...e))},(0,i.zw)(e.$t("newrole.confirm")),513),[[a.F8,-1==n.validType]])])])):(0,o.kq)("",!0)}var Q=s(31400),X={components:{InputText:Q.Z,svgloader:P.Z},data(){return{roleData:{group_name:{text:"",valid:!1},group_desc:{text:"",valid:!1}},isShow:!0,groupNames:[],validType:-1,maskId:0}},methods:{addRole(){this.isShow=!1,this.onConfirm&&this.onConfirm(this.roleData),N.g.descend(this.maskId)},cancel(){this.isShow=!1,this.onCancel&&this.onCancel(),N.g.descend(this.maskId)},initStatus(){this.maskId=N.g.rise(15,this.cancel)},initRoleNames(){for(let e of this.groups)this.groupNames.push(e.group_name)}},computed:{roleNameValid(){return-1==this.validType},roleNameReason(){return 1==this.validType?this.$t("dlgaddrole.reasonOne"):2==this.validType?this.$t("dlgaddrole.reasonTwo"):""}},props:{prmsnRoles:{type:Object,default:()=>({[()=>(void 0).$t("dlgaddrole.worker")]:0,[()=>(void 0).$t("dlgaddrole.technician")]:1,[()=>(void 0).$t("dlgaddrole.engineer")]:2,[()=>(void 0).$t("dlgaddrole.manager")]:3,[()=>(void 0).$t("dlgaddrole.supervisor")]:4,[()=>(void 0).$t("dlgaddrole.boss")]:5})},groups:{type:Object,default:function(){return{}}}},watch:{roleData:{deep:!0,immediate:!0,handler:function(){let e=this.roleData.group_name.text;""==e?this.validType=1:-1!=this.groupNames.indexOf(e)?this.validType=2:this.validType=-1}}},mounted(){this.initStatus(),this.initRoleNames()}};const ee=(0,Z.Z)(X,[["render",M],["__scopeId","data-v-405c7d00"]]);var te=ee;const se=(e={})=>{if("object"!=typeof e)throw new Error("props must be a object");return new Promise(((t,s)=>{let o=(0,a.ri)(te,e).use(A.Z).mount(document.createElement("div"));document.body.appendChild(o.$el),o.onConfirm=function(e){t(e)},o.onCancel=function(e){s(e)}}))};var oe=se,ie=s(80283),ae=s(15637),le={components:{LeetxButton:ae.Z},data(){return{module:"AUTH_GROUP",actvRole:-1,itemsLength:10,groups:[],newRole:{group_name:{text:"",valid:!1},group_desc:{text:"",valid:!1}}}},methods:{operateUsr(e){this.actvRole=this.actvRole==e?-1:e},editRolePrmsns(){B({group_id:this.groups[this.actvRole].group_id,group_name:this.groups[this.actvRole].group_name})},addRoleDialog(){let e=this.groups;oe({groups:e}).then((async e=>{for(let t in this.newRole)this.newRole[t]=e[t].text;this.addGroup(this.newRole)}))},async addGroup(e){await(0,_.hI)(e).then((e=>{0!=e.status&&O.c.error(["添加用户组失败"])})).catch((()=>{O.c.error(["添加用户组失败"])})),this.getGroupList()},delGroup(){let e=this.groups[this.actvRole].group_id,t=this.$t("setrole.delgroup"),s=this.$t("setrole.yes"),o=this.$t("setrole.no"),i=this.$t("setrole.isDelGroup");(0,ie.Z)({title:t,confirmText:s,cancelText:o,msg:i}).then((()=>{(0,_.xW)(e),1==this.groups.length&&(this.groups=[]),this.getGroupList(),this.resetRole()}))},getGroupList(){(0,_.vb)().then((e=>{0==e.status?this.groups=e.data:this.groups=[]})).catch((()=>{this.groups=[]}))},resetRole(){this.actvRole=-1},resetData(){this.actvRole=-1,this.itemsLength=10,this.groups=[],this.newRole={group_name:{text:"",valid:!1},group_desc:{text:"",valid:!1}}}},created(){this.permision_level>=1&&this.getGroupList()},computed:{permision_level(){return this.module in this.$store.state.f_status.permissions?this.$store.state.f_status.permissions[this.module]:0}}};const ne=(0,Z.Z)(le,[["render",f],["__scopeId","data-v-6d029ea3"]]);var re=ne}}]);
//# sourceMappingURL=107.6ca2da25.js.map