"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[538],{62527:function(t,e,s){s.r(e),s.d(e,{default:function(){return B}});var i=s(66252),a=s(3577);const r=t=>((0,i.dD)("data-v-71e97ad1"),t=t(),(0,i.Cn)(),t),o={class:"files-box"},n={class:"operate-line"},l=r((()=>(0,i._)("br",null,null,-1))),c=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),p=r((()=>(0,i._)("br",null,null,-1))),u=r((()=>(0,i._)("span",null,null,-1))),h=[p,u],f=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),d=r((()=>(0,i._)("br",null,null,-1))),m=r((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),_=r((()=>(0,i._)("br",null,null,-1))),v={class:"items-box"},$=["onClick"],g={class:"file-name"},b={class:"add-box"},P={class:"act-box"},w=r((()=>(0,i._)("br",null,null,-1)));function L(t,e,s,r,p,u){const L=(0,i.up)("svg-loader"),y=(0,i.up)("LeetxButton");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",n,[(0,i._)("div",{class:"operate-box",onClick:e[0]||(e[0]=(...t)=>u.addPf&&u.addPf(...t))},[(0,i.Wm)(L,{class:"pfIcon",icon:"AddTwo",size:"2.5rem"}),l,(0,i._)("span",null,(0,a.zw)(t.$t("profile.add")),1)]),c,(0,i._)("div",{class:(0,a.C_)(["activate-Pf",[u.notAllowActivate?"not-allow-activate":"operate-box"]]),onClick:e[1]||(e[1]=(...t)=>u.activatePf&&u.activatePf(...t))},h,2),f,(0,i._)("div",{class:"operate-box",onClick:e[2]||(e[2]=(...t)=>u.editPf&&u.editPf(...t))},[(0,i.Wm)(L,{class:"pfIcon",icon:"EditTwo",size:"2.5rem"}),d,(0,i._)("span",null,(0,a.zw)(t.$t("profile.editor")),1)]),m,(0,i._)("div",{class:"operate-box delete-box",onClick:e[3]||(e[3]=(...t)=>u.delPf&&u.delPf(...t))},[(0,i.Wm)(L,{class:"pfIcon",icon:"TrashOne",size:"2.5rem"}),_,(0,i._)("span",null,(0,a.zw)(t.$t("profile.delete")),1)])]),(0,i._)("div",v,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.pfList.length,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"profile-item",onClick:e=>u.selectFile(t-1)},[(0,i.Wm)(L,{class:(0,a.C_)({"file-static-icon":!0,"file-active-icon":p.active_item==t-1}),icon:p.active_item==t-1?"ActivePf":"StaticPf",size:"10.5rem"},null,8,["class","icon"]),(0,i._)("span",{class:(0,a.C_)({"pf-static-num":!0,"pf-active-num":p.active_item==t-1})},(0,a.zw)(u.getPfNum(t)),3),(0,i._)("span",g,(0,a.zw)(p.pfList[t-1]["name"]),1)],8,$)))),128)),(0,i._)("div",b,[(0,i.Wm)(y,{module:p.module,onClick:u.addPf,class:"file-static-icon",borderRadius:"0","use-icon":!0,icon:"AddTwo",bgcColor:"transparent",iconSize:"2.5rem"},null,8,["module","onClick"])])]),(0,i._)("div",P,[(0,i._)("div",{class:(0,a.C_)(["activate-Pf",[u.notAllowActivate?"not-allow-activate":"operate-box"]]),onClick:e[4]||(e[4]=(...t)=>u.activatePf&&u.activatePf(...t))},[(0,i.Wm)(L,{class:"pfIcon",icon:"RightOne",size:"2.5rem"}),w,(0,i._)("span",null,(0,a.zw)(t.$t("profile.activate")),1)],2)])])}var y=s(74125),k=s(84965),E=s(32015),x=s(90343),C=s(10335),F=s(22805),z=s(49963);const A={components:{LeetxButton:C.Z},data(){return{module:"PROFILE",pstmodule:"SELPSET",pfList:[],active_item:-1}},methods:{getPfNum(t){let e=this.pfList[t-1].mode,s=this.pfList[t-1].pset;switch(e){case 1:return s<10?`F0${s}`:`F${s}`;case 2:return s<10?`E0${s}`:`E${s}`;default:break}},delPf(){if(-1==this.active_item)return;let t=this.pfList[this.active_item].pset;if(t==this.activatePset){let t=this.$t("promsg.no_delete");return void k.c.warning([t])}let e=`${this.$t("promsg.is_del")}${this.pfList[this.active_item].pset}`;this.$route.path.startsWith("/profile")&&this.$route.query&&this.$route.query.pset==t&&(e=this.$t("promsg.deleteFileEditing")),(0,E.Z)({title:this.$t("promsg.del"),confirmText:this.$t("promsg.yes"),cancelText:this.$t("promsg.no"),msg:e}).then((()=>{(0,y.rz)({pset:this.pfList[this.active_item].pset}).then((e=>{this.$bus.emit("delPset",{pset:t}),9130!=e.status?9125!=e.status?0==e.status?(this.$route.path.startsWith("/profile")&&this.$route.query&&this.$route.query.pset==t&&this.$router.push({path:this.$route.path,query:{pset:-1}}),this.operateFile({action:"sub"}),k.c.success([this.$t("promsg.del_suc")])):k.c.warning([this.$t("promsg.nexit"),this.$t("promsg.has_del")]):k.c.warning(["文件不存在或已经删除"]):k.c.error(["删除失败"])})).catch((()=>{k.c.error(["删除失败"]),this.operateFile({action:"sub"})})),this.active_item=-1}))},addPf(){(0,x.Z)({pfList:this.pfList}).then((t=>{let e=t.pset;(0,y.cy)(t.Profile).then((s=>{9121!=s.status?9123!=s.status?(0==s.status?t.Profile.Profile.Mode in F.lK?this.$router.push({path:F.lK[t.Profile.Profile.Mode],query:{pset:e}}):this.$router.push({path:"/profile",query:{pset:e}}):k.c.error([this.$t("promsg.add_fail")]),this.operateFile({action:"add"})):k.c.warning(["文件写入数据库失败"]):k.c.warning(["Pset或文件名重复"])})).catch((()=>{k.c.error([this.$t("promsg.add_fail")]),this.operateFile({action:"add"})}))}))},sortBy(t){return function(e,s){return e[t]-s[t]}},editPf(){if(-1==this.active_item)return;let t=this.pfList[this.active_item];t.mode in F.lK?this.$router.push({path:F.lK[t.mode],query:{pset:t.pset}}):this.$router.push({path:"/profile",query:{pset:t.pset}}),this.operateFile({action:"edit"})},activatePf(){if(1!=this.$store.state.g_status.psetsrc){let t=this.$t("promsg.msgOne"),e=this.$t("promsg.msgTwo");return void k.c.warning([t,e])}if(-1==this.active_item)return void k.c.error([this.$t("promsg.nselect_file")]);if(this.pfList[this.active_item].pset==this.$store.state.g_status.pset)return void k.c.warning([this.$t("promsg.file_locate")]);if(this.$store.state.g_status.busy)return void k.c.warning([this.$t("promsg.run_status"),this.$t("promsg.nactivate_file")]);let t=this.pfList[this.active_item].pset;(0,y.TU)(t).then((t=>{9126!=t.status&&9129!=t.status?(0==t.status?k.c.success([this.$t("promsg.activate_suc")]):k.c.error("激活失败!"),this.operateFile({action:"activate"})):k.c.warning(["下位机切换文件失败"])})).catch((()=>{k.c.error([this.$t("promsg.activate_fail")]),this.operateFile({action:"activate"})}))},selectFile(t){this.active_item=t==this.active_item?-1:t},updateActiveItem(){let t=-1;for(let e=0;e<this.pfList.length;e++)if(this.pfList[e].pset==this.activatePset){t=e;break}this.active_item=t},getPfList(t){(0,y.Lm)().then((e=>{9127!=e.status&&0==e.status?(this.pfList=e.data.sort(this.sortBy("pset")),this.updateActiveItem(),t&&t()):this.pfList=[]})).catch((()=>{this.pfList=[]}))},operateFile(t){switch(t.action){case"add":this.showprofile_lst=!1,this.getPfList();break;case"sub":this.getPfList();break;case"edit":this.showprofile_lst=!1;break;case"close":this.showprofile_lst=!1;break}}},props:{fileItems:{type:Array,default:function(){return[]}}},watch:{fileItems:{immediate:!0,deep:!0,handler:function(){this.pfList=this.fileItems,this.pfList.sort(this.sortBy("pset"))}}},created(){this.getPfList()},unmounted(){},computed:{notAllowActivate(){return 1!=this.$store.state.g_status.psetsrc},activatePset(){return this.$store.state.g_status.pset},enabled(){return this.module in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.module]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.3},actEnable(){return this.pstmodule in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions[this.pstmodule]},actPointerEvent(){return this.actEnable?"auto":"none"},actOpacity(){return this.actEnable?1:.3},prfileEnable(){return 4==this.$store.state.f_status.permissions[this.module]||4==this.$store.state.f_status.permissions[this.pstmodule]},prfilePointerEvent(){return this.prfileEnable?"auto":"none"},prfileOpacity(){return this.prfileEnable?1:.3}}},I=()=>{(0,z.sj)((t=>({"2f5b9e14":t.actPointerEvent,b29f7418:t.actOpacity,"29b4ee78":t.pointerEvent,21574710:t.opacity,"8c923054":t.prfilePointerEvent,"0a7a6af2":t.prfileOpacity})))},q=A.setup;A.setup=q?(t,e)=>(I(),q(t,e)):I;var T=A,O=s(83744);const W=(0,O.Z)(T,[["render",L],["__scopeId","data-v-71e97ad1"]]);var B=W}}]);
//# sourceMappingURL=538.720db021.js.map