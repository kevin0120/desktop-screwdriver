"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[27],{3185:function(t,e,s){s.d(e,{I0:function(){return a},Lk:function(){return l},YL:function(){return n},i:function(){return o},v3:function(){return r}});var i=s(11586);function o(t){return(0,i.Z)({url:"pf/jobmod",method:"post",data:t})}function n(t){return(0,i.Z)({url:`pf/cur/job?id=${t}`,method:"get"})}function l(){return(0,i.Z)({url:"pf/cur/joblst",method:"get"})}function a(t){return(0,i.Z)({url:"pf/jobdel",method:"post",params:t})}function r(t){return(0,i.Z)({url:`pf/cur/jobsel?job=${t}`,method:"get"})}},59317:function(t,e,s){function i(t){let e;if(t instanceof Array){e=[];for(let s=0;s<t.length;s++)e[s]=i(t[s])}else if(t instanceof Object){e={};for(let s of Object.keys(t))e[s]=i(t[s])}else e=t;return e}function o(t,e,s=!1){let i=!0;if(t instanceof Array&&e instanceof Array&&e.length==t.length){for(let n=0;n<t.length;n++)if(i=i&&o(t[n],e[n],s),!i)break}else if(!(t instanceof Object&&e instanceof Object)||t instanceof Array||e instanceof Array)t instanceof Object||e instanceof Object?i=!1:(i=!0,s&&(i=t===e));else for(let n in t){if(!(n in e)){i=!1;break}if(i=i&&o(t[n],e[n],s),!i)break}return i}function n(t,e,s=!1){return s?JSON.stringify(t)===JSON.stringify(e):o(t,e)}s.d(e,{IK:function(){return n},p$:function(){return i}})},69027:function(t,e,s){s.r(e),s.d(e,{default:function(){return rt}});var i=s(66252),o=s(3577);const n=t=>((0,i.dD)("data-v-8e48f2b4"),t=t(),(0,i.Cn)(),t),l={class:"tech-box"},a={class:"tech-basemsg-line"},r={class:"job-name-title"},h=n((()=>(0,i._)("div",{class:"job-options-box_line_top1"},null,-1))),c={class:"tech-basemsg-line"},u={class:"tech-num-3"},m={class:"tech-num-top"},d=n((()=>(0,i._)("div",{class:"job-options-box_line_top2"},null,-1))),b={class:"tech-basemsg-line"},p={class:"tech-num-3"},f={class:"tech-num-top"},_=n((()=>(0,i._)("div",{class:"job-options-box_line_top3"},null,-1))),g={class:"operate-line"},v=n((()=>(0,i._)("br",null,null,-1))),j=n((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),J=n((()=>(0,i._)("br",null,null,-1))),N=n((()=>(0,i._)("div",null,[(0,i._)("span",{class:"line"})],-1))),S=n((()=>(0,i._)("br",null,null,-1))),P={class:"delete-span"},w=n((()=>(0,i._)("div",{class:"job-options-box_line_top4"},null,-1))),y={key:0,class:"job-options-box"},$={key:0,class:"job-options-box_line1"},C=n((()=>(0,i._)("div",{class:"job-options-box_f"},"&",-1))),I=n((()=>(0,i._)("div",{class:"job-options-box_line2"},null,-1))),x=["onClick"],O={class:"pf-static-num"},k={class:"file-name"},V={key:1,class:"pro-step-data"},A={class:"tech-basemsg-line"},R={class:"tech-pset"},z={class:"tech-basemsg-line"},L={class:"tech-num"},M={class:"tech-basemsg-line"},D={class:"tech-num"},Z={class:"tech-num-2"},F={class:"tech-basemsg-line"},B={class:"tech-num"},W={class:"tech-num-2"};function E(t,e,s,n,E,G){const T=(0,i.up)("InputText"),K=(0,i.up)("LeetxSwitch"),U=(0,i.up)("InputVal"),q=(0,i.up)("svg-loader"),Y=(0,i.up)("NewSelect"),H=(0,i.up)("LeetxButton");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",a,[(0,i._)("span",r,(0,o.zw)(this.$t("job.job"))+" "+(0,o.zw)(E.JobId.toString().padStart(3,"0"))+" "+(0,o.zw)(this.$t("job.edit")),1)]),h,(0,i._)("div",c,[(0,i._)("span",u,(0,o.zw)(this.$t("job.jobName")),1),(0,i.Wm)(T,{module:E.module,class:"tech-input-top",width:"20vw",disabled:!0,text:E.Name,"onUpdate:modelValue":e[0]||(e[0]=t=>E.Name=t.text),textValid:""==G.nameReason,validReason:G.nameReason},null,8,["module","text","textValid","validReason"]),(0,i._)("span",m,(0,o.zw)(this.$t("job.autoChoose")),1),(0,i.Wm)(K,{class:"tech-input-2",module:E.module,value:E.AutoSelPset,activeVal:!0,staticVal:!1,height:2,onSentVal:e[1]||(e[1]=t=>E.AutoSelPset=t)},null,8,["module","value"])]),d,(0,i._)("div",b,[(0,i._)("span",p,(0,o.zw)(this.$t("job.ngCount")),1),(0,i.Wm)(U,{imprprChrctr:E.limitBtn,minNum:0,maxNum:9999,module:E.module,sensorValue:E.MaxNGCount,width:"10rem",class:"tech-input-3","onUpdate:sensorValue":e[2]||(e[2]=t=>E.MaxNGCount=t)},null,8,["imprprChrctr","module","sensorValue"]),(0,i._)("span",f,(0,o.zw)(this.$t("job.reused")),1),(0,i.Wm)(K,{module:E.module,value:E.Reused,activeVal:!0,staticVal:!1,height:2,class:"tech-input-4",onSentVal:e[3]||(e[3]=t=>E.Reused=t)},null,8,["module","value"])]),_,(0,i._)("div",g,[(0,i._)("div",{class:"operate-box-stroke",onClick:e[4]||(e[4]=(...t)=>G.addParallelPf&&G.addParallelPf(...t))},[(0,i.Wm)(q,{class:"pfIcon",icon:"Addparallel",size:"2.5rem"}),v,(0,i._)("span",null,(0,o.zw)(this.$t("job.parallelAdd")),1)]),j,(0,i._)("div",{class:"operate-box-stroke",onClick:e[5]||(e[5]=(...t)=>G.addSerialPf&&G.addSerialPf(...t))},[(0,i.Wm)(q,{class:"pfIcon",icon:"Addserial",size:"2.5rem"}),J,(0,i._)("span",null,(0,o.zw)(this.$t("job.serialAdd")),1)]),N,(0,i._)("div",{class:"operate-box",onClick:e[6]||(e[6]=(...t)=>G.deletePf&&G.deletePf(...t))},[(0,i.Wm)(q,{class:"pfIcon",icon:"TrashOne",size:"2.5rem"}),S,(0,i._)("span",P,(0,o.zw)(this.$t("job.delete")),1)])]),w,0!=E.JobItems.length?((0,i.wg)(),(0,i.iD)("div",y,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(E.JobItems,((t,e)=>((0,i.wg)(),(0,i.iD)("div",{key:e,class:"job-options-box_1"},[e?((0,i.wg)(),(0,i.iD)("div",$)):(0,i.kq)("",!0),C,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{key:s,class:"job-options-box_2"},[I,(0,i._)("div",{class:(0,o.C_)({"job-options-box_4":!0,"job-options-box_4_active":E.active_item_i==e&&E.active_item_j==s}),onClick:t=>G.selectFile(e,s)},[(0,i.Wm)(q,{class:(0,o.C_)({"file-static-icon":!0}),icon:E.active_item_i==e&&E.active_item_j==s?"ActiveJob":"StaticJob"},null,8,["icon"]),(0,i._)("span",O,(0,o.zw)(t.Pset),1),(0,i._)("span",k,(0,o.zw)(this.$t("job.num"))+"ï¼š"+(0,o.zw)(t.BatchSize),1)],10,x)])))),128))])))),128))])):(0,i.kq)("",!0),-1!=E.curJobId?((0,i.wg)(),(0,i.iD)("div",V,[(0,i._)("div",A,[(0,i._)("span",R,(0,o.zw)(this.$t("job.pset")),1),(0,i.Wm)(Y,{isScroll:!0,bottom:!0,width:36.5,module:E.module,realVal:G.currentPset.Pset,isAllowChng:!0,class:"tech-input-1",fontSize:"1.25rem",options:E.profileOptionNameLst,onValChng:e[7]||(e[7]=t=>G.setParams("Pset",t))},null,8,["width","module","realVal","options"])]),(0,i._)("div",z,[(0,i._)("span",L,(0,o.zw)(this.$t("job.num")),1),(0,i.Wm)(U,{imprprChrctr:E.limitBtn,maxNum:9999,minNum:1,module:E.module,sensorValue:G.currentPset.BatchSize,fontSize:"1.25rem",width:"13.5rem",class:"tech-input-1",onUpdateData:e[8]||(e[8]=t=>G.setParams("BatchSize",t.sensorValue))},null,8,["imprprChrctr","module","sensorValue"])]),(0,i._)("div",M,[(0,i._)("span",D,(0,o.zw)(this.$t("job.okCountMode")),1),(0,i.Wm)(Y,{bottom:!0,fntSize:"1.25rem",valLeft:"-0.3rem",module:E.module,width:13.5,realVal:G.currentPset.OnlyCntOK,isAllowChng:!0,class:"tech-input-1",options:E.okCountOpt,onValChng:e[9]||(e[9]=t=>G.setParams("OnlyCntOK",t))},null,8,["module","width","realVal","options"]),(0,i._)("span",Z,(0,o.zw)(this.$t("job.reverseAng")),1),(0,i.Wm)(U,{module:E.module,class:"tech-input",maxNum:500,minNum:0,height:"3.125rem",fontSize:"1.25rem",width:"12rem",uname:"angle",showUnitName:!1,sensorValue:G.currentPset.ReverseOk,"onUpdate:sensorValue":e[10]||(e[10]=t=>G.currentPset.ReverseOk=t)},null,8,["module","sensorValue"])]),(0,i._)("div",F,[(0,i._)("span",B,(0,o.zw)(this.$t("job.inReduceCountMode")),1),(0,i.Wm)(Y,{bottom:!0,module:E.module,width:13.5,realVal:G.currentPset.DecLoosening,isAllowChng:!0,fntSize:"1.25rem",valLeft:"-0.3rem",class:"tech-input-1",options:E.inReduceCount,onValChng:e[11]||(e[11]=t=>G.setParams("DecLoosening",t))},null,8,["module","width","realVal","options"]),(0,i._)("span",W,(0,o.zw)(this.$t("job.reverseMode")),1),(0,i.Wm)(Y,{bottom:!0,module:E.module,width:12,realVal:G.currentPset.LooseningMode,isAllowChng:!0,fntSize:"1.25rem",valLeft:"-0.3rem",class:"tech-input",options:E.reverseMode,onValChng:e[12]||(e[12]=t=>G.setParams("LooseningMode",t))},null,8,["module","realVal","options"])])])):(0,i.kq)("",!0),(0,i.Wm)(H,{enablerun:!1,module:E.module,width:"30.3125rem",height:"3.75rem",onClick:G.confirm,textColor:"#fff",text:t.$t("knowhat.save"),fontFamily:"'SourceHanSansCN-Bold'",fontSize:"2.25rem",bgcColor:"#00c155",class:"confirm-box"},null,8,["module","onClick","text"])])}var G=s(59317),T=s(22805),K=s(30703),U=s(70032),q=s(16496),Y=s(84965),H=s(3185),Q=s(74125),X=s(57414),tt=s(92797),et=s(49963);const st={components:{NewSelect:q.Z,InputText:K.Z,InputVal:U.Z},data(){return{module:"JOB",profile:{},curJobId:-1,need_check_edit:!1,delPsetNum:0,profileNameLst:[],defaultPset:{Pset:0,RetriesLimit:!0,Retries:1,BatchSizeLimit:!0,BatchSize:10,LooseningMode:0,OnlyCntOK:1,ForceBatchStatus:0,DecLoosening:0,ReverseOk:0},profileOptionNameLst:{},active_item_i:0,active_item_j:0,Name:"job1",JobId:1,Descr:"",Ver:"1.0.0",Mode:1,Reused:!0,JobSelSource:0,AutoSelPset:!1,MaxNGCount:10,global_json_name:"",global_json_maxNg:"",global_json_AutoSelPsetg:"",global_json_reused:"",global_job_params_data:"",JobItems:[],verifyZero:!0,okCountOpt:{},inReduceCount:{},reverseMode:{},limitBtn:[".","-"]}},beforeRouteLeave(t,e,s){if(this.saveVerify(),!this.verifyZero)return Y.c.warning([this.$t("job.psetNumNoZero")]),void s(!1);if(""!=this.nameReason&&-1!=this.curPsetId)return Y.c.warning([this.$t("job.jobInvalidName")]),void s(!1);let i=this.global_job_params_data==JSON.stringify(this.profile),o=this.global_json_name==JSON.stringify(this.Name),n=this.global_json_maxNg==JSON.stringify(this.MaxNGCount),l=this.global_json_AutoSelPsetg==JSON.stringify(this.AutoSelPset),a=this.global_json_reused==JSON.stringify(this.Reused);if(i&&o&&n&&l&&a)s();else{let t=this.$t("setcontrol.saveJob"),e=this.$t("setcontrol.yes"),i=this.$t("setcontrol.no"),o=this.$t("setcontrol.isSaveJob");(0,X.Z)({title:t,confirmText:e,cancelText:i,msg:o}).then((async()=>{await this.confirm(),s()})).catch((()=>{s()}))}},methods:{initOptions(){let t=this.$t("job.allCount"),e=this.$t("job.okCount"),s=this.$t("job.inReduceCount"),i=this.$t("job.neverReduceCount"),o=this.$t("job.inOkReduceCount"),n=this.$t("job.neverReverse"),l=this.$t("job.allowReverse"),a=this.$t("job.nokReverse");this.okCountOpt={[t]:0,[e]:1},this.inReduceCount={[i]:0,[s]:1,[o]:2},this.reverseMode={[n]:0,[l]:1,[a]:2}},selectFile(t,e){this.active_item_i=t,this.active_item_j=e},setParams(t,e){this.JobItems[this.active_item_i][this.active_item_j][t]=e},setboolParams(t,e){this.JobItems[this.active_item_i][this.active_item_j][t]=e},addParallelPf(){this.JobItems[this.active_item_i].splice(this.active_item_j+1,0,(0,G.p$)(this.defaultPset)),this.active_item_j++},addSerialPf(){this.JobItems[this.active_item_i+1]=this.JobItems[this.active_item_i+1]?this.JobItems[this.active_item_i+1]:[],this.JobItems[this.active_item_i+1].unshift((0,G.p$)(this.defaultPset)),this.active_item_i++,this.active_item_j=0},deletePf(){console.log("delete");let t=this.$t("job.delPset"),e=this.$t("tchnlgy.yes"),s=this.$t("tchnlgy.no"),i=this.$t("job.isDelPset");(0,X.Z)({title:t,confirmText:e,cancelText:s,msg:i}).then((()=>{const t=Math.max(this.active_item_i-1,0);this.JobItems[this.active_item_i].splice(this.active_item_j,1),0==this.JobItems[this.active_item_i].length?(this.JobItems.splice(this.active_item_i,1),this.active_item_i=t,this.active_item_j=0):this.active_item_j=Math.min(this.active_item_j,this.JobItems[this.active_item_i].length-1),0==this.JobItems.length&&(this.JobItems=[[(0,G.p$)(this.defaultPset)]],this.profile.JobItems=this.JobItems)}))},saveVerify(){for(let t=0;t<this.profile.JobItems.length;t++)for(let e=0;e<this.profile.JobItems[t].length;e++){const s=this.profile.JobItems[t][e].Pset;if(0===s)return this.verifyZero=!1,void Y.c.error([this.$t("job.psetNumNoZero")]);this.verifyZero=!0}},async confirm(){if(""!=this.nameReason&&-1!=this.curPsetId)return void Y.c.warning([this.$t("job.jobInvalidName")]);this.profile.Name=this.Name,this.profile.JobId=this.JobId,this.profile.Descr=this.Descr,this.profile.Ver=this.Ver,this.profile.Mode=this.Mode,this.profile.Reused=this.Reused,this.profile.JobSelSource=this.JobSelSource,this.profile.AutoSelPset=this.AutoSelPset,this.profile.MaxNGCount=this.MaxNGCount;let t=!0;for(let e=0;e<this.profile.JobItems.length;e++){let s=[];for(let i=0;i<this.profile.JobItems[e].length;i++){const o=this.profile.JobItems[e][i].Pset;if(0===o)return t=!1,this.verifyZero=!1,void Y.c.error([this.$t("job.psetNumNoZero")]);if(this.verifyZero=!0,!Object.values(this.profileOptionNameLst).includes(o))return t=!1,void Y.c.error([this.$t("job.psetNotExist",[o])]);if(s.includes(o))return t=!1,void Y.c.error([this.$t("job.noRepeat")]);s.push(o)}}this.need_check_edit=!1,t&&await this.sendFileToServerApi(this.profile,this.saveSuccess)},backStaticBox(){this.activeBox=-1},async sendFileToServerApi(t,e){if(!this.enabledEdit)return Y.c.warning([this.$t("tchnlgy.isRunning"),this.$t("tchnlgy.noModified")]);try{const s=await(0,H.i)({Profile:t});this.need_check_edit=!1,e&&e(s)}catch(s){console.log("pfModJobApi profile error ",s),Y.c.error([tt.Z.global.t("job.saveFail")])}},getFileContentByJobApi(t,e,s){(0,H.YL)(t).then((t=>{e&&e(t)})).catch((t=>{console.log("getFileContent profile error ",t),s&&s(t)}))},getCurJobProfile(t){t&&t>0&&this.getFileContentByJobApi(t,(e=>{if(0===e.status){let s=e.data.Profile;this.profile=s,this.setFileContent(s),this.curJobId=t,this.need_check_edit=!0,this.global_job_params_data=JSON.stringify(this.profile)}else this.curJobId=-1,this.need_check_edit=!1,Y.c.warning([this.$t("job.getFileFail")])}),(()=>{this.curJobId=-1,this.need_check_edit=!1,Y.c.warning([this.$t("job.getFileFail")])}))},setFileContent(t){this.profile=t,this.Name=this.profile.Name,this.Descr=this.profile.Descr,this.Ver=this.profile.Ver,this.Mode=this.profile.Mode,this.Reused=this.profile.Reused,this.JobSelSource=this.profile.JobSelSource,this.AutoSelPset=this.profile.AutoSelPset,this.MaxNGCount=this.profile.MaxNGCount,this.JobItems=this.profile.JobItems,this.global_json_name=JSON.stringify(this.Name),this.global_json_maxNg=JSON.stringify(this.MaxNGCount),this.global_json_AutoSelPsetg=JSON.stringify(this.AutoSelPset),this.global_json_reused=JSON.stringify(this.Reused)},initEmptyProfile(){this.profile=(0,T.mK)(2),this.setFileContent(this.profile)},excuteDefaultAction(){this.JobId=parseInt(this.$route.query.job),this.curJobId=this.JobId,this.curJobId>0&&this.getCurJobProfile(this.curJobId)},getPfList(t){(0,Q.Lm)().then((e=>{9127!=e.status&&0==e.status&&(e.data.sort(((t,e)=>t.pset-e.pset)).forEach((t=>{this.profileOptionNameLst[t.pset+" | "+t.name]=t.pset})),t&&t())})).catch((()=>{}))},getJobPfList(t){(0,H.Lk)().then((e=>{9127!=e.status&&0==e.status&&(e.data.forEach((t=>{t.job!=this.curJobId&&this.profileNameLst.push(t.name)})),t&&t())})).catch((()=>{}))},saveSuccess(t){0==t.status?(this.global_job_params_data=JSON.stringify(this.profile),this.global_json_name=JSON.stringify(this.Name),this.global_json_maxNg=JSON.stringify(this.MaxNGCount),this.global_json_AutoSelPsetg=JSON.stringify(this.AutoSelPset),this.global_json_reused=JSON.stringify(this.Reused),Y.c.success([this.$t("setop.saveSuc")])):9131==t.status?Y.c.warning([this.$t("tchnlgy.fileUnchanged")]):9125==t.status?Y.c.warning([this.$t("tchnlgy.fileNotExit")]):9128==t.status?Y.c.warning([this.$t("tchnlgy.versionInconsistent")]):9129==t.status?Y.c.warning([this.$t("tchnlgy.modifyFileFail")]):Y.c.error([this.$t("tchnlgy.saveFail"),[`[${t.status}]`]])},checkDelPfPset(){this.$bus.on("delPset",(t=>{this.delPsetNum=t.pset,this.profile}))}},computed:{currentPset(){return this.JobItems[this.active_item_i][this.active_item_j]},currentPsetlist(){return this.JobItems[this.active_item_i][this.active_item_j]},enabledEdit(){return 0==(this.curJobId==this.$store.state.g_status.pset&&this.$store.state.g_status.busy)},nameReason(){return-1==this.curJobId?-1:0==this.Name.length?this.$t("dlgprogram.jobNameNotEmpty"):this.Name&&this.profileNameLst.length>0&&-1!=this.profileNameLst.indexOf(this.Name)?this.$t("dlgprogram.jobNameRepeat"):""},enabled(){return"JOB"in this.$store.state.f_status.permissions&&4==this.$store.state.f_status.permissions["JOB"]},pointerEvent(){return this.enabled?"auto":"none"},opacity(){return this.enabled?1:.5}},created(){this.getPfList(),this.getJobPfList(),this.initEmptyProfile(),this.checkDelPfPset(),this.initOptions()},watch:{"$route.query.job":{immediate:!0,handler:function(){this.excuteDefaultAction()}}}},it=()=>{(0,et.sj)((t=>({"4cad973c":t.pointerEvent,"391576e6":t.opacity})))},ot=st.setup;st.setup=ot?(t,e)=>(it(),ot(t,e)):it;var nt=st,lt=s(83744);const at=(0,lt.Z)(nt,[["render",E],["__scopeId","data-v-8e48f2b4"]]);var rt=at}}]);
//# sourceMappingURL=27.c3f749e1.js.map