"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[967],{59317:function(e,s,t){function i(e){let s;if(e instanceof Array){s=[];for(let t=0;t<e.length;t++)s[t]=i(e[t])}else if(e instanceof Object){s={};for(let t of Object.keys(e))s[t]=i(e[t])}else s=e;return s}function a(e,s,t=!1){let i=!0;if(e instanceof Array&&s instanceof Array&&s.length==e.length){for(let r=0;r<e.length;r++)if(i=i&&a(e[r],s[r],t),!i)break}else if(!(e instanceof Object&&s instanceof Object)||e instanceof Array||s instanceof Array)e instanceof Object||s instanceof Object?i=!1:(i=!0,t&&(i=e===s));else for(let r in e){if(!(r in s)){i=!1;break}if(i=i&&a(e[r],s[r],t),!i)break}return i}function r(e,s,t=!1){return t?JSON.stringify(e)===JSON.stringify(s):a(e,s)}t.d(s,{IK:function(){return r},p$:function(){return i}})},92967:function(e,s,t){t.r(s),t.d(s,{default:function(){return ye}});var i=t(66252),a=t(3577),r=t(49963);const n=e=>((0,i.dD)("data-v-c45e6e86"),e=e(),(0,i.Cn)(),e),d={class:"users-nav"},l={class:"id-span"},o={class:"name-span"},u=n((()=>(0,i._)("span",{class:"edit-span"},null,-1))),c={class:"mask-box"},p={class:"table-box"},h=["onClick"],m={class:"id-span"},w={class:"name-span"},g={class:"role-span"},v={key:0,class:"edit-span"},f={class:(0,a.C_)({"users-item":!0,"add-line":!0})},y={key:0,class:"id-span"},_=n((()=>(0,i._)("span",{class:"name-span"},null,-1))),U=n((()=>(0,i._)("span",{class:"role-span"},null,-1))),k=n((()=>(0,i._)("span",{class:"edit-span"},null,-1)));function x(e,s,t,n,x,T){const C=(0,i.up)("svg-loader"),b=(0,i.up)("LeetxButton");return(0,i.wg)(),(0,i.iD)("div",{class:"users-mng-box",onClick:s[0]||(s[0]=(...s)=>e.isClickOpearteBox&&e.isClickOpearteBox(...s))},[(0,i._)("div",d,[(0,i._)("span",l,(0,a.zw)(e.$t("setuser.username")),1),(0,i._)("span",o,(0,a.zw)(e.$t("setuser.roleedit")),1),(0,i._)("span",{class:"role-span",ref:"editUsr"},(0,a.zw)(e.$t("setuser.liveTime")),513),u]),(0,i._)("div",c,[(0,i._)("div",p,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(x.users,((s,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:(0,a.C_)({"users-item":!0,"active-user":x.actvUsr==t}),onClick:e=>T.operateUsr(t)},[(0,i._)("span",m,(0,a.zw)(s.user_name),1),(0,i._)("span",w,(0,a.zw)(s.group_name),1),(0,i._)("span",g,(0,a.zw)(e.$t("setuser.noLimit")),1),4==T.permision_level?((0,i.wg)(),(0,i.iD)("span",v,[(0,i.wy)((0,i.Wm)(C,{onClick:T.editUserDialog,class:"edit-btn",icon:"ActiveEditUser",size:"2.5rem"},null,8,["onClick"]),[[r.F8,x.actvUsr==t]]),(0,i.wy)((0,i.Wm)(C,{onClick:T.delUser,class:"trash-btn",icon:"DelDmrct",size:"2.5rem"},null,8,["onClick"]),[[r.F8,x.actvUsr==t]])])):(0,i.kq)("",!0)],10,h)))),128)),(0,i._)("div",f,[4==T.permision_level?((0,i.wg)(),(0,i.iD)("span",y,[(0,i.Wm)(b,{module:x.module,onClick:T.addUserDialog,class:"add-btn","use-icon":!0,icon:"StaticCircleAdd",bgcColor:"transparent",height:"2.5rem",width:"2.5rem",iconSize:"2.5rem"},null,8,["module","onClick"])])):(0,i.kq)("",!0),_,U,k])])])])}var T=t(69947);const C=e=>((0,i.dD)("data-v-1412889e"),e=e(),(0,i.Cn)(),e),b={key:0,class:"eidtuser-box"},N={class:"eidtuser-title-line"},$={class:"eidtuser-title-msg"},D={class:"eidtuser-name-line"},V={class:"eidtuser-name-text"},I={class:"eidtuser-role-line"},S={class:"eidtuser-role-text"},z=C((()=>(0,i._)("br",null,null,-1))),R={class:"edituser-operate-line"};function O(e,s,t,n,d,l){const o=(0,i.up)("svgloader"),u=(0,i.up)("InputText"),c=(0,i.up)("NewSelect");return d.isShow?((0,i.wg)(),(0,i.iD)("div",b,[(0,i._)("div",N,[(0,i._)("span",$,(0,a.zw)(e.$t("dlgedituser.editUser")),1),(0,i._)("span",{class:"edituser-box-close",onClick:s[0]||(s[0]=(...e)=>l.cancel&&l.cancel(...e))},[(0,i.Wm)(o,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,i._)("div",D,[(0,i._)("div",V,(0,a.zw)(e.$t("dlgedituser.name")),1),(0,i.Wm)(u,{text:t.olduser.user_name,imprprChrctr:["space"],textValid:-1==d.validNameType,validReason:l.nameReason,class:"eidtuser-name-input",modelValue:d.user.user_name,"onUpdate:modelValue":s[1]||(s[1]=e=>d.user.user_name=e)},null,8,["text","textValid","validReason","modelValue"])]),(0,i._)("div",I,[(0,i._)("div",S,(0,a.zw)(e.$t("dlgedituser.newRole")),1),(0,i.Wm)(c,{class:"eidtuser-name-input",width:18.4768,realVal:d.user.group_id.text,onValChng:s[2]||(s[2]=e=>d.user.group_id.text=e),options:d.groupInfo},null,8,["width","realVal","options"])]),z,(0,i._)("div",R,[(0,i._)("div",{class:"edituser-cancel-btn",onClick:s[3]||(s[3]=(...e)=>l.cancel&&l.cancel(...e))},(0,a.zw)(e.$t("dlgedituser.cancel")),1),(0,i.wy)((0,i._)("div",{class:"edituser-cnfrm-btn",onClick:s[4]||(s[4]=(...e)=>l.sbmtUserInfo&&l.sbmtUserInfo(...e))},(0,a.zw)(e.$t("dlgedituser.confirm")),513),[[r.F8,0!=t.groups.length&&-1==d.validNameType]])])])):(0,i.kq)("",!0)}var W=t(77671),P=t(73496),A=t(92165),Z=t(65884),j={components:{InputText:W.Z,svgloader:P.Z,NewSelect:A.Z},data(){return{user:{user_id:{text:"",valid:!1},user_name:{text:"",valid:!1},email:{text:"",valid:!1},group_id:{text:"",valid:!1},others:{text:"",valid:!1}},groupInfo:{},isShow:!0,validNameType:-1,maskId:0}},methods:{sbmtUserInfo(){this.isShow=!1;let e=this.user,s=this.olduser;this.onConfirm&&this.onConfirm({user:e,olduser:s}),Z.g.descend(this.maskId)},cancel(){this.isShow=!1,this.onCancel&&this.onCancel(),Z.g.descend(this.maskId)},initGroupInfo(){for(let e=0;e<this.groups.length;e++)this.groupInfo[this.groups[e].group_name]=this.groups[e].group_id},initStatus(){this.maskId=Z.g.rise(15,this.cancel)},updateUserValidType(){""==this.user.user_name.text?this.validNameType=1:this.olduser.user_name!=this.user.user_name.text&&-1!=this.names.indexOf(this.user.user_name.text)?this.validNameType=2:this.user.user_name.text.length>10?this.validNameType=3:this.validNameType=-1}},props:{groups:{type:Object,default:function(){return{}}},olduser:{type:Object,default:function(){return{}}},names:{type:Array,default:function(){return[]}}},watch:{olduser:{immediate:!0,deep:!0,handler:function(){for(let e in this.user)this.user[e].text=this.olduser[e]}},groups:{immediate:!0,deep:!0,handler:function(){this.initGroupInfo()}},"user.user_name":{deep:!0,immediate:!0,handler:function(){this.updateUserValidType()}}},computed:{nameReason(){return-1==this.validNameType?"":1==this.validNameType?this.$t("dlgadduser.nameReasonOne"):2==this.validNameType?this.$t("dlgadduser.nameReasonTwo"):3==this.validNameType?this.$t("dlgadduser.nameReasonThree"):""}},mounted(){this.initStatus()}},L=t(83744);const G=(0,L.Z)(j,[["render",O],["__scopeId","data-v-1412889e"]]);var E=G,F=t(15997);const q=(e={})=>{if("object"!=typeof e)throw new Error("props must be a object");return new Promise(((s,t)=>{let i=(0,r.ri)(E,e).use(F.Z).mount(document.createElement("div"));document.body.appendChild(i.$el),i.onConfirm=function(e){s(e)},i.onCancel=function(e){t(e)}}))};var B=q;const K={key:0,class:"adduser-box"},H={class:"adduser-title-line"},J={class:"adduser-title-msg"},M={class:"adduser-name-line"},X={class:"adduser-name-text"},Y={class:"adduser-pswrd-line"},Q={class:"adduser-name-text"},ee={class:"adduser-worknum-line"},se={class:"adduser-worknum-text"},te={class:"adduser-role-line"},ie={class:"adduser-role-text"},ae={class:"adduser-operate-line"};function re(e,s,t,n,d,l){const o=(0,i.up)("svgloader"),u=(0,i.up)("InputText"),c=(0,i.up)("InputVal"),p=(0,i.up)("NewSelect");return d.isShow?((0,i.wg)(),(0,i.iD)("div",K,[(0,i._)("div",H,[(0,i._)("span",J,(0,a.zw)(e.$t("newuser.newuser")),1),(0,i._)("span",{class:"adduser-box-close",onClick:s[0]||(s[0]=(...e)=>l.cancel&&l.cancel(...e))},[(0,i.Wm)(o,{class:"icon-close",icon:"Close",size:"1.2rem"})])]),(0,i._)("div",M,[(0,i._)("div",X,(0,a.zw)(e.$t("newuser.username")),1),(0,i.Wm)(u,{imprprChrctr:d.illegalWords,textValid:-1==d.validNameType,validReason:l.nameReason,text:"",placeholder:e.$t("newuser.usernamemsg"),class:"adduser-name-input",modelValue:d.userData.user,"onUpdate:modelValue":s[1]||(s[1]=e=>d.userData.user=e)},null,8,["imprprChrctr","textValid","validReason","placeholder","modelValue"])]),(0,i._)("div",Y,[(0,i._)("div",Q,(0,a.zw)(e.$t("newuser.initialPswrd")),1),(0,i.Wm)(u,{imprprChrctr:["space"],textValid:-1==d.validPswrdType,validReason:l.pwdReason,placeholder:e.$t("newuser.pswrdmsg"),class:"adduser-pswrd-input",type:l.pswdOrtext,modelValue:d.userData.pwd,"onUpdate:modelValue":s[2]||(s[2]=e=>d.userData.pwd=e)},null,8,["textValid","validReason","placeholder","type","modelValue"]),(0,i.wy)((0,i.Wm)(o,{icon:l.eyeType,class:"user-pswd-eye",size:"1.5rem",onClick:l.showPswrd},null,8,["icon","onClick"]),[[r.F8,l.haseye]])]),(0,i._)("div",ee,[(0,i._)("div",se,(0,a.zw)(e.$t("newuser.worknumber")),1),(0,i.Wm)(c,{class:"adduser-worknum-input",sensorValue:0,isInt:!0,isLimit:!1,onUpdateData:s[3]||(s[3]=e=>d.userData.workNum=e)})]),(0,i._)("div",te,[(0,i._)("div",ie,(0,a.zw)(e.$t("newuser.prmsnrole")),1),(0,i.Wm)(p,{class:"adduser-name-input",width:17.625,realVal:d.userData.group_id.text,options:l.getGroups(),onValChng:s[4]||(s[4]=e=>d.userData.group_id.text=e)},null,8,["width","realVal","options"])]),(0,i._)("div",ae,[(0,i._)("div",{class:"adduser-cancel-btn",onClick:s[5]||(s[5]=(...e)=>l.cancel&&l.cancel(...e))},(0,a.zw)(e.$t("dlgadduser.cancel")),1),0!=t.groups.length&&l.allowAddUser?(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{key:0,class:"adduser-cnfrm-btn",onClick:s[6]||(s[6]=(...e)=>l.sbmtUserInfo&&l.sbmtUserInfo(...e))},(0,a.zw)(e.$t("dlgadduser.sure")),513)),[[r.F8,0!=t.groups.length]]):(0,i.kq)("",!0)])])):(0,i.kq)("",!0)}var ne=t(22213),de={components:{InputText:W.Z,svgloader:P.Z,NewSelect:A.Z,InputVal:ne.Z},data(){return{userData:{user:{text:"",valid:!1},pwd:{text:"",valid:!1},workNum:{text:0,valid:!1},group_id:{text:this.groups[0].group_id,valid:!0}},isShow:!0,isShowPswrd:!1,illegalWords:[",",".",":",";","'",'"',"?","!","-","+","/","=","(",")","space"],validNameType:1,validWorkerNumType:1,validPswrdType:1,maskId:0}},methods:{showPswrd(){this.isShowPswrd=!this.isShowPswrd},sbmtUserInfo(){this.isShow=!1,this.onConfirm&&this.onConfirm(this.userData),Z.g.descend(this.maskId)},cancel(){this.isShow=!1,this.onCancel&&this.onCancel(),Z.g.descend(this.maskId)},getGroups(){let e={};for(let s in this.groups)e[this.groups[s].group_name]=this.groups[s].group_id;return e},initStatus(){this.maskId=Z.g.rise(15,this.cancel)},updateWorkNumValidType(){""==this.userData.workNum?this.validWorkerNumType=1:this.validWorkerNumType=-1},updateUserValidType(){""==this.userData.user.text?this.validNameType=1:-1!=this.names.indexOf(this.userData.user.text)?this.validNameType=2:this.validNameType=-1},updatePswrdValidType(){""==this.userData.pwd.text?this.validPswrdType=1:this.validPswrdType=-1}},props:{groups:{type:Object,default:function(){return{}}},names:{type:Array,default:function(){return[]}}},watch:{groups:{deep:!0,handler:function(){this.groups}},"userData.user":{deep:!0,immediate:!0,handler:function(){this.updateUserValidType()}},"userData.pwd":{deep:!0,immediate:!0,handler:function(){this.updatePswrdValidType()}},"userData.workNum":{deep:!0,immediate:!0,handler:function(){this.updateWorkNumValidType()}},names:{deep:!0,handler:function(){this.updateUserValidType()}}},computed:{pswdOrtext(){return this.isShowPswrd?"text":"password"},haseye(){return this.userData.pwd.text.length>0},eyeType(){return this.isShowPswrd?"OpenEye":"CloseEye"},nameReason(){return-1==this.validNameType?"":1==this.validNameType?this.$t("dlgadduser.nameReasonOne"):2==this.validNameType?this.$t("dlgadduser.nameReasonTwo"):3==this.validNameType?this.$t("dlgadduser.nameReasonThree"):""},pwdReason(){return-1==this.validPswrdType?"":1==this.validPswrdType?this.$t("dlgadduser.pwdReasonOne"):2==this.validPswrdType?this.$t("dlgadduser.pwdReasonTwo"):""},numReason(){return 1==this.validWorkerNumType?"":1==this.validWorkerNumType?this.$t("dlgadduser.numReasonOne"):""},allowAddUser(){let e=!0;return e=e&&-1==this.validNameType,e=e&&-1==this.validPswrdType,e=e&&-1==this.validWorkerNumType,e}},mounted(){this.initStatus()}};const le=(0,L.Z)(de,[["render",re],["__scopeId","data-v-06a6893d"]]);var oe=le;const ue=(e={})=>{if("object"!=typeof e)throw new Error("props must be a object");return new Promise(((s,t)=>{let i=(0,r.ri)(oe,e).use(F.Z).mount(document.createElement("div"));document.body.appendChild(i.$el),i.onConfirm=function(e){s(e)},i.onCancel=function(e){t(e)}}))};var ce=ue,pe=t(32015),he=t(59317),me=t(12346),we=t(84965),ge=t(10335),ve={components:{LeetxButton:ge.Z},data(){return{module:"AUTH_GROUP",actvUsr:-1,users:[],groups:[],newUser:{user:"",pwd:"",workNum:"",group_id:""},oldUser:{user_id:"",user_name:"",email:"",group_id:"",others:""},isLogin:0,userNames:[]}},methods:{operateUsr(e){this.actvUsr=this.actvUsr==e?-1:e},editUserDialog(){B({groups:this.groups,olduser:this.users[this.actvUsr],names:this.userNames}).then((async e=>{for(let s in this.oldUser)this.oldUser[s]=e.user[s].text;(0,he.IK)(this.oldUser,e.oldUser,!0)||(await this.editUser(this.oldUser),setTimeout((()=>{if(e.olduser.user_name==this.$store.state.f_status.user){(0,me.Z)();let e=this.$t("logout.success"),s=this.$t("logout.loginAgain");we.c.success([e,s])}}),500))}))},addUserDialog(){this.groups.length<=0||ce({groups:this.groups,names:this.userNames}).then((e=>{for(let s in this.newUser)this.newUser[s]=e[s].text;this.addUser(this.newUser)}))},async addUser(e){e=e||{user:"user"+1e4*Math.random().toFixed(3),pwd:123456,group_id:1},await(0,T.XW)(e).then((e=>{0!=e.status?we.c.error(["添加用户失败"]):this.getUserList()})).catch((()=>{})),this.getUserList()},delUser(){let e=this.users[this.actvUsr].user_id,s=this.$t("setuser.deluser"),t=this.$t("setuser.yes"),i=this.$t("setuser.no"),a=this.$t("setuser.isDelGroup");(0,pe.Z)({title:s,confirmText:t,cancelText:i,msg:a}).then((()=>{(0,T.wC)(e).then((e=>{0!=e.status&&we.c.error(["删除用户失败"])})).catch((()=>{})),this.getUserList(),this.restActiveUser()}))},getGroupList(){(0,T.vb)().then((e=>{0==e.status?(this.groups=e.data,this.initUserNames()):this.groups=[]}))},getUserList(){(0,T.uj)().then((e=>{0==e.status?(this.users=e.data,this.initUserNames()):this.users=[]}))},async editUser(e){await(0,T.Ki)(e),this.getUserList()},restActiveUser(){this.actvUsr=-1},resetData(){this.actvUsr=-1,this.users=[],this.groups=[]},initUserNames(){this.userNames=[];for(let e of this.users)this.userNames.push(e.user_name)}},created(){this.permision_level>=1&&(this.getUserList(),this.getGroupList())},computed:{permision_level(){return this.module in this.$store.state.f_status.permissions?this.$store.state.f_status.permissions[this.module]:0}}};const fe=(0,L.Z)(ve,[["render",x],["__scopeId","data-v-c45e6e86"]]);var ye=fe}}]);
//# sourceMappingURL=967.ee86c38a.js.map