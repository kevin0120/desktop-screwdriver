"use strict";(self["webpackChunkleetx_web"]=self["webpackChunkleetx_web"]||[]).push([[236],{59317:function(e,t,a){function n(e){let t;if(e instanceof Array){t=[];for(let a=0;a<e.length;a++)t[a]=n(e[a])}else if(e instanceof Object){t={};for(let a of Object.keys(e))t[a]=n(e[a])}else t=e;return t}function s(e,t,a=!1){let n=!0;if(e instanceof Array&&t instanceof Array&&t.length==e.length){for(let l=0;l<e.length;l++)if(n=n&&s(e[l],t[l],a),!n)break}else if(!(e instanceof Object&&t instanceof Object)||e instanceof Array||t instanceof Array)e instanceof Object||t instanceof Object?n=!1:(n=!0,a&&(n=e===t));else for(let l in e){if(!(l in t)){n=!1;break}if(n=n&&s(e[l],t[l],a),!n)break}return n}function l(e,t,a=!1){return a?JSON.stringify(e)===JSON.stringify(t):s(e,t)}a.d(t,{IK:function(){return l},p$:function(){return n}})},19236:function(e,t,a){a.r(t),a.d(t,{default:function(){return le}});var n=a(66252),s=a(3577);const l=e=>((0,n.dD)("data-v-268f7372"),e=e(),(0,n.Cn)(),e),i={class:"data-box"},o={class:"tech-basemsg-line"},r={class:"tech-num"},d={key:0,class:"tech-select"},m={class:"tech-name"},u={class:"form-box"},c={class:"inner-box"},h={class:"form-item torque-unit"},g={class:"form-item angle-unit"},f={class:"form-item speed-unit"},p=l((()=>(0,n._)("div",{class:"form-item zero"},[(0,n._)("span",null,"0.0")],-1))),b=l((()=>(0,n._)("span",{class:"v-text"},"V1",-1))),S=l((()=>(0,n._)("span",{class:"v-text"},"V2",-1))),w={class:"btn-box"};function x(e,t,a,l,x,_){const P=(0,n.up)("InputText"),V=(0,n.up)("svg-loader"),N=(0,n.up)("InputVal"),A=(0,n.up)("FormItem"),D=(0,n.up)("FormItemTwo"),M=(0,n.up)("LeetxButton");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("div",o,[(0,n._)("span",r,(0,s.zw)(e.$t("tchnlgy.prcsid"))+":",1),-1!=x.curPsetId?((0,n.wg)(),(0,n.iD)("div",d,(0,s.zw)(x.curPsetId.toString().padStart(3,"0")),1)):(0,n.kq)("",!0),(0,n._)("span",m,(0,s.zw)(e.$t("tchnlgy.prcsname")),1),-1!=x.curPsetId?((0,n.wg)(),(0,n.j4)(P,{key:1,module:x.module,class:"tech-input",disabled:!0,text:x.file.Name,"onUpdate:modelValue":t[0]||(t[0]=e=>x.file.Name=e.text),width:"24vw",textValid:""==_.nameReason,validReason:_.nameReason},null,8,["module","text","textValid","validReason"])):(0,n.kq)("",!0),-1!=x.curPsetId?((0,n.wg)(),(0,n.j4)(V,{key:2,onClick:_.showGlobalConfig,class:"tech-setting",icon:"StaticSetting",size:"2.5rem"},null,8,["onClick"])):(0,n.kq)("",!0)]),(0,n._)("div",u,[(0,n.Wm)(A,{class:"pro-text",label:e.$t("tchnlgy.timeOut")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,minNum:2e3,uname:"time",sensorValue:x.NewStandardModeData.ActionPara.Timeout_mS,"onUpdate:sensorValue":t[1]||(t[1]=e=>x.NewStandardModeData.ActionPara.Timeout_mS=e)},null,8,["module","sensorValue"])])),_:1},8,["label"])]),(0,n._)("div",c,[(0,n.Wm)(V,{class:"standard-mode-icon",icon:"StandardMode",size:"30rem"}),(0,n._)("div",h,(0,s.zw)(e.$t("monitor.torque"))+"/"+(0,s.zw)(_.sensorUnit("torque")),1),(0,n._)("div",g,(0,s.zw)(e.$t("monitor.angle"))+"/"+(0,s.zw)(_.sensorUnit("angle")),1),(0,n._)("div",f,(0,s.zw)(e.$t("monitor.speed"))+"/"+(0,s.zw)(_.sensorUnit("angle_speed")),1),p,(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item max-angle-text",label:e.$t("selftapping.maxtorque")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"torque",showUnitName:!1,"min-num":x.NewStandardModeData.ActionPara.Target,maxNum:1.2*this.$store.state.g_status.sensor_max,sensorValue:x.NewStandardModeData.ActionPara.ResultTorque.Max,"onUpdate:sensorValue":t[2]||(t[2]=e=>x.NewStandardModeData.ActionPara.ResultTorque.Max=e)},null,8,["module","min-num","maxNum","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item target-angle-text",label:e.$t("strategy.targetTorque")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"torque",showUnitName:!1,"min-num":x.NewStandardModeData.ActionPara.ResultTorque.Min,"max-num":x.NewStandardModeData.ActionPara.ResultTorque.Max,sensorValue:x.NewStandardModeData.ActionPara.Target,"onUpdate:sensorValue":t[3]||(t[3]=e=>x.NewStandardModeData.ActionPara.Target=e)},null,8,["module","min-num","max-num","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item min-angle-text",label:e.$t("selftapping.mintorque")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"torque",showUnitName:!1,"max-num":x.NewStandardModeData.ActionPara.Target,sensorValue:x.NewStandardModeData.ActionPara.ResultTorque.Min,"onUpdate:sensorValue":t[4]||(t[4]=e=>x.NewStandardModeData.ActionPara.ResultTorque.Min=e)},null,8,["module","max-num","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item torque-threshold-text",label:e.$t("release.torqueThreshold")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"torque",showUnitName:!1,sensorValue:x.NewStandardModeData.ActionPara.ThresholdValue,"onUpdate:sensorValue":t[5]||(t[5]=e=>x.NewStandardModeData.ActionPara.ThresholdValue=e)},null,8,["module","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item min-angle",label:e.$t("tighten.miniAngle")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"angle",showUnitName:!1,"max-num":x.NewStandardModeData.ActionPara.ResultAngle.Max,sensorValue:x.NewStandardModeData.ActionPara.ResultAngle.Min,"onUpdate:sensorValue":t[6]||(t[6]=e=>x.NewStandardModeData.ActionPara.ResultAngle.Min=e)},null,8,["module","max-num","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(A,{labelSize:"1.25rem",leftDis:"0",labelWidth:"5rem",class:"form-item max-angle",label:e.$t("tighten.maxAngle")},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,height:"2.4rem",fontSize:"1.25rem",width:"6.4rem",uname:"angle",showUnitName:!1,"min-num":x.NewStandardModeData.ActionPara.ResultAngle.Min,sensorValue:x.NewStandardModeData.ActionPara.ResultAngle.Max,"onUpdate:sensorValue":t[7]||(t[7]=e=>x.NewStandardModeData.ActionPara.ResultAngle.Max=e)},null,8,["module","min-num","sensorValue"])])),_:1},8,["label"]),(0,n.Wm)(D,{flexDir:"row",class:"vOne"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,fontSize:"1.25rem",height:"2.4rem",width:"6.4rem",uname:"angle_speed","show-unit-name":!1,sensorValue:x.NewStandardModeData.ActionPara.Velocity,"onUpdate:sensorValue":t[8]||(t[8]=e=>x.NewStandardModeData.ActionPara.Velocity=e)},null,8,["module","sensorValue"]),b])),_:1}),(0,n.Wm)(D,{flexDir:"row",class:"vTwo"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{module:x.module,fontSize:"1.25rem",height:"2.4rem",width:"6.4rem",uname:"angle_speed","show-unit-name":!1,sensorValue:x.NewStandardModeData.ActionPara.TightenVelocity,"onUpdate:sensorValue":t[9]||(t[9]=e=>x.NewStandardModeData.ActionPara.TightenVelocity=e)},null,8,["module","sensorValue"]),S])),_:1})]),(0,n._)("div",w,[(0,n.Wm)(M,{module:x.module,class:"confirm-box",textColor:"#fff",borderRadius:"4px",bgcColor:"#00c155",fontSize:"2.25rem",fontFamily:"--SHSC-B",text:e.$t("dbgdmrct.save"),onClick:_.submitStandardData},null,8,["module","text","onClick"])])])}var _=a(22213),P=a(59317),V=a(10335),N=a(46613),A=a(77671),D=a(74125),M=a(84965),v=a(69314);const q=v.s;function y(){return{Name:"...",Pset:1,Ver:"1.0.0",Sequence:{GlobalParams:{AutoPowerOn:!0,AutoPowerOff:!1,Direction:"CW",SampleFrequency:q.hightSetting.DefaultSampleFrequency,SamplingNumber:q.hightSetting.DefaultSampleNum,CalibrationeOn:!0,GlobalAngleMonitoring:!0,ThresholdValue:q.hightSetting.DefaultStartTorque,AngleLimit:{Min:q.hightSetting.MinAngle,Max:q.hightSetting.MaxAngle}},Branchs:[{Name:"MainBranch",Axis:{Name:"MainSpindle",StartMode:"csv",Direction:"CW"},Start:0,End:1,SeqItems:[]}]}}}var T=a(22805),W=a(32015),C=a(49963),z=a(15997);const I={key:0,class:"set-tech-box"},k={class:"head-text-line"},$={class:"time-line"},R={class:"tech-num"},O={class:"sampling-line"},U={class:"sampling-rate"},L={class:"max-line"},j={class:"max-samples"},G={class:"dir-line"},Z={class:"default-dir"};function F(e,t,a,l,i,o){const r=(0,n.up)("svgloader"),d=(0,n.up)("InputVal"),m=(0,n.up)("NewSelect"),u=(0,n.up)("LeetxButton");return i.isShow?((0,n.wg)(),(0,n.iD)("div",I,[(0,n._)("div",k,[(0,n._)("span",null,(0,s.zw)(e.$t("hightsetting.advancedSettings")),1),(0,n._)("span",{class:"cancel-box",onClick:t[0]||(t[0]=(...e)=>o.cancel&&o.cancel(...e))},[(0,n.Wm)(r,{class:"tech-setting",icon:"Close",size:"1.2rem"})])]),(0,n._)("div",$,[(0,n._)("span",R,(0,s.zw)(e.$t("hightsetting.startingTorque")),1),(0,n.Wm)(d,{sensorValue:i.globalParams.ThresholdValue,"onUpdate:sensorValue":t[1]||(t[1]=e=>i.globalParams.ThresholdValue=e),class:"tech-input",width:"18rem",uname:"torque"},null,8,["sensorValue"])]),(0,n._)("div",O,[(0,n._)("span",U,(0,s.zw)(e.$t("hightsetting.samplingRate")),1),(0,n.Wm)(m,{options:i.frequencys,realVal:i.globalParams.SampleFrequency,"onUpdate:realVal":t[2]||(t[2]=e=>i.globalParams.SampleFrequency=e),class:"sampling-select"},null,8,["options","realVal"])]),(0,n._)("div",L,[(0,n._)("span",j,(0,s.zw)(e.$t("hightsetting.maxSamples")),1),(0,n.Wm)(m,{options:i.samplingDots,realVal:i.globalParams.SamplingNumber,"onUpdate:realVal":t[3]||(t[3]=e=>i.globalParams.SamplingNumber=e),class:"max-samples-select"},null,8,["options","realVal"])]),(0,n._)("div",G,[(0,n._)("span",Z,(0,s.zw)(e.$t("hightsetting.defRotationDirection")),1),(0,n.Wm)(m,{options:i.dirs,realVal:i.globalParams.Direction,"onUpdate:realVal":t[4]||(t[4]=e=>i.globalParams.Direction=e),class:"default-dir-btn"},null,8,["options","realVal"])]),(0,n.Wm)(u,{bgcColor:"#00c155",textColor:"#fff",width:"30.3125rem",fontSize:"2.25rem",class:"confirm-box",text:"确认",onClick:o.confirmInner},null,8,["onClick"])])):(0,n.kq)("",!0)}var B=a(73496),E=a(92165),J=a(65884),H={components:{InputVal:_.Z,svgloader:B.Z,LeetxButton:V.Z,NewSelect:E.Z},data(){return{frequencys:{"100sps":100,"250sps":250,"500sps":500,"1000sps":1e3},dirs:{[this.$t("hightsetting.foreward")]:"CW",[this.$t("hightsetting.reverse")]:"CCW"},samplingDots:{1e3:1e3,2e3:2e3,5e3:5e3,1e4:1e4},isShow:!0,maskId:0,globalParams:void 0,angleRangeValid:!0}},methods:{cancel(){this.isShow=!1,J.g.descend(this.maskId)},confirmInner(){if(!this.angleRangeValid){let e=this.$t("hightsetting.globalMonitpers"),t=this.$t("hightsetting.wrongRange");return M.c.warning([e,t])}this.isShow=!1,this.onConfirm&&this.onConfirm(this.globalParams),J.g.descend(this.maskId)},modData(e,t){const a=["ThresholdValue","AngleMin","AngleMax"];-1!==a.indexOf(e)?"ThresholdValue"===e?this.globalParams[e]=t.sensorValue:"AngleMin"===e?this.globalParams.AngleLimit.Min=t.sensorValue:this.globalParams.AngleLimit.Max=t.sensorValue:this.globalParams[e]=t},initStatus(){this.maskId=J.g.rise(15)},initGlobalParams(){this.globalParams=(0,P.p$)(this.GlobalParams)}},created(){this.initGlobalParams()},mounted(){this.initStatus()},props:{GlobalParams:{AutoPowerOn:!0,AutoPowerOff:!1,Direction:"CW",SampleFrequency:1e3,SamplingNumber:1e4,CalibrationeOn:!0,GlobalAngleMonitoring:!1,ThresholdValue:0,AngleLimit:{Min:-50,Max:50},ReverseSpeedValue:10,ReverseAngleValue:0}},computed:{},watch:{globalParams:{deep:!0,handler:function(){this.angleRangeValid=this.globalParams.AngleLimit.Min<this.globalParams.AngleLimit.Max}}}},K=a(83744);const X=(0,K.Z)(H,[["render",F],["__scopeId","data-v-555b977c"]]);var Y=X;const Q=e=>new Promise(((t,a)=>{let n=(0,C.ri)(Y,e).use(z.Z).mount(document.createElement("div"));document.body.appendChild(n.$el),n.onConfirm=e=>{t(e),console.log("xxxxxxxxxxxxx",e)},n.onCancel=function(e){a(e)}}));const ee={components:{InputVal:_.Z,LeetxButton:V.Z,InputText:A.Z},data(){return{module:"PROFILE",NewStandardModeData:(0,N.Z)(),curPsetId:-1,file:y(),profileNameLst:[],need_check_edit:!1,global_name_json:"",global_paras_json:"",global_advanced_paras_json:""}},methods:{showGlobalConfig(){let e=this.file.Sequence.GlobalParams;Q({GlobalParams:e}).then((e=>{this.file.Sequence.GlobalParams=e,this.need_check_edit=!0})).catch((e=>{e&&console.log(e)}))},getPfList(e){(0,D.Lm)().then((t=>{9127!=t.status&&0==t.status&&(this.NameLst=[],this.profileNameLst=[],t.data.forEach((e=>{e.pset!=this.curPsetId&&this.profileNameLst.push(e.name)})),e&&e())})).catch((()=>{}))},sensorUnit(e){return this.$store.state.sensors[e].name},excuteDefaultAction(){this.getPfList(),this.curPsetId=this.$route.query.pset,void 0!==this.curPsetId&&(0,D.Y3)(this.curPsetId).then((e=>{this.need_check_edit=!0,this.file=e.data.Profile,this.global_name_json=JSON.stringify(e.data.Profile.Name),this.global_advanced_paras_json=JSON.stringify(this.file.Sequence.GlobalParams),e.data.Profile.Sequence.Branchs[0].SeqItems.forEach((e=>{"Standard"==e.Action&&(this.NewStandardModeData=(0,P.p$)(e),this.global_paras_json=JSON.stringify(this.NewStandardModeData))}))})).catch((e=>{console.log("getFileContent  error ",e)}))},submitStandardData(){if(""==this.nameReason||-1==this.curPsetId){if(!this.enabledEdit)return M.c.warning(["该文件处于运行状态","不允许修改"]);this.file.Sequence.Branchs[0].SeqItems=(0,T.t2)([this.NewStandardModeData]),this.need_check_edit=!1,(0,D.FX)({Profile:this.file}).then((()=>{this.need_check_edit=!1,M.c.success(["保存成功"]),this.excuteDefaultAction()})).catch((e=>{console.log("pfModApi  error ",e),M.c.error(["工艺文件保存失败"])}))}else M.c.warning(["文件名不合法"])},isChanged(){let e=this.global_paras_json==JSON.stringify(this.NewStandardModeData),t=this.global_name_json==JSON.stringify(this.file.Name),a=this.global_advanced_paras_json==JSON.stringify(this.file.Sequence.GlobalParams);return!(e&&t&&a||0==this.need_check_edit)},openDialog(){let e="保存工艺",t="是",a="否",n="是否保存工艺?";(0,W.Z)({title:e,confirmText:t,cancelText:a,msg:n}).then((()=>{this.submitStandardData(),this.excuteDefaultAction()})).catch((()=>{this.excuteDefaultAction()}))}},props:{stepData:{type:Object,default:function(){return{startAngle:0,endAngle:0,maxTorque:0,minTorque:0,leftTorque:0,rightTorque:0,triggerTorque:0,getValWay:0,prefabTorqueMode:0,angleClear:0,torqueClear:0}}}},beforeRouteLeave(e,t,a){if(""!=this.nameReason&&-1!=this.curPsetId)return M.c.warning(["文件名不合法"]),void a(!1);if(this.isChanged()){let e="保存工艺",t="是",n="否",s="是否保存工艺?";(0,W.Z)({title:e,confirmText:t,cancelText:n,msg:s}).then((()=>{this.submitStandardData(),a()})).catch((()=>{a()}))}else a()},watch:{"$route.query.pset":{immediate:!0,handler:function(e){void 0!=e&&(this.isChanged()?this.openDialog():this.excuteDefaultAction())}}},created(){this.getPfList()},computed:{nameReason(){return-1==this.curPsetId?-1:0==this.file.Name.length?"文件名不能为空":this.file.Name&&this.profileNameLst.length>0&&-1!=this.profileNameLst.indexOf(this.file.Name)?"文件名重复":""},enabledEdit(){return 0==(this.curPsetId==this.$store.state.g_status.pset&&this.$store.state.g_status.busy)}}},te=()=>{(0,C.sj)((e=>({"5d306bfc":e.pointerEvent,ad8731e8:e.opacity})))},ae=ee.setup;ee.setup=ae?(e,t)=>(te(),ae(e,t)):te;var ne=ee;const se=(0,K.Z)(ne,[["render",x],["__scopeId","data-v-268f7372"]]);var le=se}}]);
//# sourceMappingURL=236.de644ffa.js.map